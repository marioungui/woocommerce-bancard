![](_page_0_Picture_0.jpeg)

![](_page_0_Picture_1.jpeg)

# VPOS 2.O

 **Colaborando para construir tu negocio en internet**

Especificaciones T√©cnicas Single Buy Versi√≥n 1.19

![](_page_0_Picture_5.jpeg)

![](_page_1_Picture_0.jpeg)

![](_page_1_Picture_1.jpeg)

# Control de cambios

| Secci√≥n/hoja                    | Versi√≥n      | Fecha      | Descripci√≥n                                                                              |  |
|---------------------------------|--------------|------------|------------------------------------------------------------------------------------------|--|
| Pago ocasional/P√°g. 8           | Versi√≥n 1.3  | 09/08/2018 | Se agrega secci√≥n "Tarjetas procesadas"                                                  |  |
| Pago con token/P√°g. 18          | Versi√≥n 1.3  | 09/08/2018 | Se agrega secci√≥n "Tarjetas procesadas"                                                  |  |
| Pagos con d√©bito                | Versi√≥n 1.3  | 09/08/2018 | Se elimina la secci√≥n de pagos con d√©bito.                                               |  |
| Catastro de tarjeta/P√°g.<br>26  | Versi√≥n 1.3  | 09/08/2018 | Se agrega la secci√≥n "Flujo de catastro"                                                 |  |
| Catastro de tarjeta/P√°g.<br>27  | Versi√≥n 1.3  | 09/08/2018 | Se agrega "Recomendaci√≥n para el comercio"                                               |  |
|                                 | Versi√≥n 1.4  | 18/09/2018 | Cambio de pago an√≥nimo por pago ocasional                                                |  |
| C√≥digo de errores -Pag<br>50    | Versi√≥n 1.5  | 15/10/2018 | Anexo C√≥digo de errores                                                                  |  |
| Catastro de tarjeta ‚Äì Pag<br>22 | Versi√≥n 1.6  | 14/01/2019 | Recomendaci√≥n para el comercio.                                                          |  |
| Single Buy Zimple ‚Äì Pag<br>17   | Versi√≥n 1.7  | 05/04/2019 | Integraci√≥n Zimple-vPOS                                                                  |  |
|                                 | Version 1.8  | 30/08/2019 | Recomendaci√≥n para aplicativos                                                           |  |
| Pag 51                          | Version 1.8  | 30/08/2019 | Paso a producci√≥n                                                                        |  |
| Pag 42                          | Version 1.9  | 11/09/2019 | Reversas operativas                                                                      |  |
| Pag 11                          | Version 1.10 | 25/08/2020 | Se agrega nueva funcionalidad del additional_data para<br>soportar m√∫ltiples promociones |  |
| Pag 21                          | Version 1.10 | 25/08/2020 | Se agrega datos de prueba de zimple                                                      |  |
|                                 | Versi√≥n 1.11 | 07/05/2021 | Agregar soporte para la Ley de Servicios Digitales                                       |  |

![](_page_1_Picture_4.jpeg)

![](_page_2_Picture_0.jpeg)

| Pag 10 ‚Äì Flag<br>preautorizacion en<br>single buy<br>Pag 35 ‚Äì Flag<br>preautorizacion en<br>charge<br>Pag 52 ‚Äì Servicio nuevo<br>para confirmar una                                                                                                                                                                                                                                                                                                   | Version 1.12 | 21/05/2021 | Agregar preautorizacion                                                                                               |  |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|------------|-----------------------------------------------------------------------------------------------------------------------|--|
| preautorizacion                                                                                                                                                                                                                                                                                                                                                                                                                                       |              |            |                                                                                                                       |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Version 1.13 | 11/01/2023 | Se quita el flujo de tet ya no valido para vpos                                                                       |  |
| Pag 33                                                                                                                                                                                                                                                                                                                                                                                                                                                | Version 1.14 | 28/08/2023 | Se agrega datos adicionales para el servicio de listar<br>tarjetas                                                    |  |
| Pag 65                                                                                                                                                                                                                                                                                                                                                                                                                                                | Versi√≥n 1.15 | 12/09/2023 | Se agrega flujo de Preautorizacion con TC y con TD                                                                    |  |
| Pag 39-40                                                                                                                                                                                                                                                                                                                                                                                                                                             | Version 1.16 | 21/03/2024 | Se agrega flujo para 3DS                                                                                              |  |
| P√°g. 8                                                                                                                                                                                                                                                                                                                                                                                                                                                | Versi√≥n 1.17 | 07/10/2024 | Agrega soporte para TD local en Pago Ocasional                                                                        |  |
| P√°g. 11                                                                                                                                                                                                                                                                                                                                                                                                                                               | Versi√≥n 1.17 | 07/10/2024 | Agrega par√°metro "extra_response_attributes"                                                                          |  |
| P√°g. 37                                                                                                                                                                                                                                                                                                                                                                                                                                               | Versi√≥n 1.17 | 16/12/2024 | Correcci√≥n del tiempo de espera de Operaci√≥n de<br>confirmaci√≥n                                                       |  |
| P√°g. 63                                                                                                                                                                                                                                                                                                                                                                                                                                               | Versi√≥n 1.18 | 13/02/2025 | Mejoras visuales sobre los formularios de catastros y<br>pagos ocasionales.                                           |  |
| Pag. 12 ‚Äì Flag billing<br>para single buy<br>P√°g. 13-16 ‚Äì Par√°metros<br>de billing a enviar en<br>single buy<br>P√°g. 22-24 ‚Äì Par√°metros<br>de billing a enviar en<br>single buy zimple<br>P√°g. 37-39 ‚Äì Par√°metros<br>de billing a enviar en<br>pago con token<br>P√°g. 45-47 ‚Äì Par√°metros<br>a recibir en responde de<br>pago ocasional y pago<br>con token<br>P√°g. 66-71 ‚Äì<br>Operaciones exclusivas<br>y consideraciones para<br>factura electr√≥nica | Versi√≥n 1.19 | 10/07/2025 | Integraci√≥n con Factura Electr√≥nica                                                                                   |  |
| P√°g. 39                                                                                                                                                                                                                                                                                                                                                                                                                                               | Versi√≥n 1.19 | 10/07/2025 | Se agrega aclaratoria con respecto al flujo de pago con<br>token para comercios del rubro Casinos y juegos de<br>azar |  |
| P√°g. 72                                                                                                                                                                                                                                                                                                                                                                                                                                               | Versi√≥n 1.19 | 10/07/2025 | Agregadas aclaraciones con respecto a la operativa de<br>confirmaci√≥n de preautorizaciones.                           |  |

![](_page_2_Picture_2.jpeg)

![](_page_3_Picture_0.jpeg)

### Contenido

<span id="page-3-0"></span>

| $\textbf{Contenido}\dots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| $Introduction \textbf{Introduction} \textbf{Introduction} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf{Function} \textbf$ |  |
| Autenticaci√≥n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |
| $Token\\$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
| Pago ocasional                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
| $\textit{Operaciones pago ocasional} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{} \textit{}$                                                                                                                                                                                                                                                                                                    |  |
| Single Buy (Pedido de pago)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |
| Single Buy Zimple (Pedido de pago con Zimple)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |
| Catastro y Pago con token                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
| Operaciones para catastro y pago con token                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |
| Catastro de Tarjeta (Cards_new)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |

![](_page_3_Picture_3.jpeg)

![](_page_4_Picture_0.jpeg)

| Recuperar Tarjetas catastradas de un usuario (users_cards)                                             |  |
|--------------------------------------------------------------------------------------------------------|--|
| Pago con token(charge)                                                                                 |  |
| Flujo 3D SECURE Pago con token - Charge                                                                |  |
| Eliminar tarjeta                                                                                       |  |
| Operaciones comunes para pago ocasional y pago con token                                               |  |
| Buy Single Confirm (Operaci√≥n de confirmaci√≥n de una transaccion)                                      |  |
| Informaci√≥n √≠ndice de riesgos                                                                          |  |
| <table>          Single Buy Rollback (Operaci√≥n de reversa de transacci√≥n)         49</table>          |  |
| Get Buy Single Confirmation(Operaci√≥n de consulta de una transacci√≥n)                                  |  |
| Preauthorization Confirm(Operaci√≥n de confirmaci√≥n de una preautorizaci√≥n)                             |  |
| <table>          Operaciones Exclusivas con Facturas Electr√≥nicas         66</table>                   |  |
| Get Client Info by RUC (Operaci√≥n para obtener datos de cliente para Factura Electr√≥nica)66            |  |
| Cancel Generated Invoice (Operaci√≥n para cancelar Factura Electr√≥nica)                                 |  |
| Flujo de una Preautorizacion:                                                                          |  |
| Flujo con Tarjeta de cr√©dito:                                                                          |  |
| Observaci√≥n:                                                                                           |  |
| Flujo con Tarjeta de d√©bito:                                                                           |  |
| Observaci√≥n:                                                                                           |  |
| Restricciones del comercio                                                                             |  |
| Solicitud de pase a producci√≥n                                                                         |  |
| Mejoras visuales sobre los formularios de catastros y pagos ocasionales                                |  |
| <table>          Transici√≥n de los formularios a los nuevos estilos</table>                            |  |
| Formulario de catastro                                                                                 |  |
| Formulario de pagos ocasionales                                                                        |  |
| Nuevas opciones de personalizaci√≥n                                                                     |  |
| Vista previa                                                                                           |  |
| $\textbf{Temas predefinidos \textbf{}\textbf{}\textbf{}\textbf{}\textbf{}\textbf{}\textbf{}\textbf{}\$ |  |
| $C\'odigo de errores - Vpos~2.081$                                                                     |  |

# <span id="page-4-0"></span>**Introducci√≥n**

El siguiente documento presenta la informaci√≥n t√©cnica necesaria para comunicarse con el servicio de pasarela de pagos de eCommerce de Bancard o VPOS.

![](_page_4_Picture_4.jpeg)

![](_page_5_Picture_0.jpeg)

El producto por construir por el comercio podr√° ser Web o Mobile. A continuaci√≥n, se detallan las distintas interacciones con servicios de la API REST, as√≠ como redirecciones necesarias a una interfaz de Bancard para solicitar los datos de la tarjeta de cr√©dito.

Adicionalmente a este documento el comercio o desarrollador de la integraci√≥n con VPOS deber√° contar con un acceso al portal de comercio de Bancard: [https://comercios.bancard.com.py](https://comercios.bancard.com.py/)

En el mismo se le brindar√° acceso para:

- Acceder al ambiente de staging y producci√≥n de vpos
- Acceder a la clave p√∫blica y privada. Adicionalmente podr√° regenerar ambas claves.
- Modificar informaci√≥n del perfil: Nombre, logo y url de confirmaci√≥n
- Traza de interacciones entre VPOS y el producto desarrollado por el comercio.
- Checklist con pasos para validar la integraci√≥n.
- Documentaci√≥n y ejemplos de c√≥digos en distintos lenguajes.

| En la traza<br>pueden<br>verificar sus<br>projectas como<br>si fuera un log.<br>Se muestra lo<br>que et.<br>comercio envia<br>y lo que el<br>servicio<br>responde.<br>Claves.<br>para<br>invocar a<br>las APIS.<br>Aqui cargar<br>la uri de<br>confirmaci√≥<br>in y pueden.<br>personalizar<br>et iframe. |                                                                                                                                                                                                  |                                                                                                                                                                                                | Lista do test a<br>chequear, se marca<br>automaticamente<br>mientras van haciendo<br>pruebas.                                                                                                                                                                | Pesta√±a donde se encuenta<br>la documentaci√≥n + tarjetas<br>de prueba. | Pesta√±a donde<br>realizan sus pruebas<br>de integraci√≥n.                                                                                                                                                                                                     |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                                                                                                                                                                                                                                                                                          | vPOS - Prueba Ecom O (78)                                                                                                                                                                        |                                                                                                                                                                                                |                                                                                                                                                                                                                                                              | Documentaci√≥n                                                          | Staging<br>Producci√≥n                                                                                                                                                                                                                                        |
|                                                                                                                                                                                                                                                                                                          | Lists de tests<br>(POS 10<br>VP08.1.8<br>Traza de actividad<br>Caves<br>Perfil de adicaci√≥n.<br>Correctos habilitados<br>Cliente de prostis.<br>(POSIO<br>(POSTA)<br>Clientes de<br>prueba donde | Permisos de staging<br>Ingreso de configuraci√≥n del cliente<br>‚úì Lm 10033-110<br>Ejecuci√≥n de cliente de prueba<br>Implementaci√≥n de pagos<br>X Reclair treaci√≥n de pago<br>X Reclaic rollhack | Habital perform th access a stopped (1990283-114)<br>Companies presis saveaux-1231<br>Ut de commenciale DAMBOR-12-92<br>Cliente de prada rescutado - IZMORT-IZ-KT.<br>Confirmance correctamente al comercio<br>Rechimos pedido de confirmaci√≥n del comercio. | TAXABABLE LINE<br><b>BITARON - THE</b><br>though the                   | Bot√≥n para solicitar la<br>certificaci√≥n, el bot√≥n<br>se habilita al<br>momento de<br>chequear por<br>completo la lista de<br>test. Al solicitar un<br>equipo de soporte<br>realiza pruebas en el<br>sitio del comercio para<br>verificar su<br>integraci√≥n. |
|                                                                                                                                                                                                                                                                                                          | pueden simular<br>el uso de las<br>APIS.                                                                                                                                                         |                                                                                                                                                                                                | Deber√°s ingresar informaci√≥n de contacto para sollicitar al pase a producci√≥n.                                                                                                                                                                               |                                                                        |                                                                                                                                                                                                                                                              |

El vPOS 2.0 cuenta con dos formas de pago, que son los siguiente:

1- **Pago ocasional**: El usuario carga siempre todos los datos de su tarjeta en el formulario realizando as√≠ el pago.

*Servicios ofrecidos:* 

![](_page_5_Picture_14.jpeg)

![](_page_6_Picture_0.jpeg)

- **single\_buy**  inicia el proceso de pago.
- 2- **Pago con token**: El usuario catastra su tarjeta y realiza el pago con un click. *Servicios ofrecidos:* 
  - **Cards\_new**  Inicia el proceso de catastro de una tarjeta.
  - **Users\_cards**  operaci√≥n que permite listar las tarjetas catastradas por un usuario.
  - **Charge**  operaci√≥n que permite el pago con un token.
  - **Delete**  operaci√≥n que permite eliminar una tarjeta catastrada.

### *Servicios que se utilizan tanto para pago ocasional como para pago con token:*

- **single\_buy\_rollback**  operaci√≥n que permite cancelar el pago (ocasional o con token).
- **get\_single\_buy\_confirmation**  operaci√≥n para consulta, si un pago (ocasional o con token) fue confirmado o no.

### *Servicios ofrecidos por el comercio*

- **single\_buy\_confirm** - operaci√≥n que ser√° invocada por VPOS para confirmar un pago (ocasional o con token).

El cliente debe ofrecer en una URL p√∫blica y de com√∫n acuerdo un servicio mediante el cual se notificar√° la aprobaci√≥n o cancelaci√≥n de la transacci√≥n de un cliente final, adem√°s para funcionar como cliente Web Service de vPOS deber√≠an soportar TLS1. 2..

# <span id="page-6-0"></span>**Autenticaci√≥n**

La clave privada y p√∫blica permitir√°n identificar todas las interacciones con los servicios del eCommerce de Bancard. Estas claves ser√°n enviadas por el producto desarrollado por el comercio en todas sus peticiones para identificarse (la clave privada **nunca** viaja en forma plana, sino *hasheada* con otra informaci√≥n en forma de *token*). Ambas pueden ser generadas nuevamente en caso de vulneraci√≥n.

La clave p√∫blica **ser√° √∫nica**, y de la forma: [a-zA-Z0-9] {32}. La clave privada no tiene porqu√© ser √∫nica (aunque seguramente lo sea), y de la forma: [a-zA-Z0-9T1] {40}.

# **Peticiones realizadas por el comercio a VPOS**

Las peticiones ser√°n realizadas por POST a una interfaz REST

| public_key | Clave p√∫blica del comercio. |
|------------|-----------------------------|

![](_page_7_Picture_0.jpeg)

| operation |  |  |
|-----------|--|--|
|           |  |  |

**operation** Datos de la operaci√≥n que se va a llevar a cabo.

"public\_key": "[public key]", "operation": { "token": "[generated token]",

} }

...

{

#### <span id="page-7-0"></span>**Token**

El token ser√° generado al momento de realizar la petici√≥n, dependiendo de la operaci√≥n. Ser√° siempre un md5 (32 caracteres). El orden debe ser exactamente como se indica.

```
 single buy 
            md5(private_key + shop_process_id + amount + currency) 
            single_buy confirm 
            md5(private_key + shop_process_id + "confirm" + amount + currency) 
            single_buy get confirmation 
            md5(private_key + shop_process_id + "get_confirmation") 
            single buy rollback 
            md5(private_key + shop_process_id + "rollback" + "0.00")
```

El token de confirm para una acci√≥n de rollback se genera usando "0.00" para amount. Al momento de generar el token, los n√∫meros deben ser transformados en cadenas, usar dos d√≠gitos decimales y un punto (".") como separador de decimales. ej.:

token = md5("[private key]" + "3332134" + "130.00" + "130.00")

#### **cards\_new**

md5(private\_key + card\_id + user\_id + "request\_new\_card")

# **users\_cards**

md5(private\_key + user\_id + "request\_user\_cards")

# **charge**

md5(private\_key + shop\_process\_id + "charge" + amount + currency +alias\_token)

![](_page_7_Picture_16.jpeg)

![](_page_8_Picture_0.jpeg)

# **delete** md5(private\_key + "delete\_card" + user\_id + card\_token)

### <span id="page-8-0"></span>**Pago ocasional**

Tarjetas procesadas

Esta operaci√≥n acepta todas las tarjetas.

El comercio carga el iframe de pago seguro de Bancard en su sitio, donde el iframe de pago ocasional queda totalmente integrado sin necesidad de que el cliente salga del sitio del comercio.

| Supermercado O'Lujo           | Sonos Productos Terretto Astronite Contacto                                                                                                                                                                                                                                                                                                             |                                                       |
|-------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
| Cocma<br>land m<br>Docwitoria | Silla de cocina<br><b>NGS</b><br>Silla de comedor color bianco. No se deforma, no se decolora-<br>Medida: 384 x 1,000 x 448mm. Soporta hasta 100Kg. Gackritia de<br>por vida.<br>$n = n - 4$ (Letterlay<br>üí® coo üõπ üåÅ üìü üî§ visa<br>1000000000000000000000000000000000000<br>AMATTE:<br>l ove<br>Installments (only for Paraguage).<br>$\mathbf{v}^{\ast}$ | Sitio del<br>comercio<br>Iframe<br>de pago<br>anonimo |
|                               | Pay (Gs. 301.004)<br>Bancard Ci                                                                                                                                                                                                                                                                                                                         |                                                       |
|                               | Comentarios.<br>Silla de muy buena calidad, regocio 100% recomendatrelli<br>Romado per Represe al 2022<br><b>Bear un comentano</b>                                                                                                                                                                                                                      |                                                       |
|                               | Copyright ¬© Supermentado D'Lujo 2018                                                                                                                                                                                                                                                                                                                    |                                                       |

#### <span id="page-8-1"></span>**Operaciones pago ocasional**

El eCommerce de Bancard cuenta con operaciones publicadas como Web Services REST disponibles para los comercios asociados que le permitir√°n realizar el flujo de un carrito en su sitio.

#### <span id="page-8-2"></span>**Single Buy (Pedido de pago)**

**POST** {environment}/vpos/api/0.3/single\_buy

Environment:

‚óè **Producci√≥n** - https://vpos.infonet.com.py

![](_page_8_Picture_13.jpeg)

![](_page_9_Picture_0.jpeg)

‚óè **Staging** - https://vpos.infonet.com.py:8888

Token: md5(private\_key + shop\_process\_id + amount + currency)

### **Operaci√≥n invocada por el comercio para iniciar el proceso de pago.**

Este servicio devolver√° un identificador de proceso (process id) que se utilizar√° para invocar el iframe de pago ocasional. Llamamos **iframe de pago ocasional** al iframe que permite cargar el formulario en el sitio del comercio.

# **Debe completarse con √©xito un Single Buy para habilitaci√≥n de la correspondiente opci√≥n en la Lista de test ->Recibir creaci√≥n de pago**

Obs1: **No** se marcar√° en la lista de test si es que en el json del pedido env√≠an test\_client.

Obs2: Si el comercio ya cuenta con el vPOS 1.0 esta operaci√≥n ya lo tiene implementada, solo deben cambiar el redirect por el iframe de pago ocasional.

### **El pedido estar√° compuesto por un JSON con los siguientes elementos:**

### Elementos de la petici√≥n

| public_key | Clave p√∫blica.     | String (50) |
|------------|--------------------|-------------|
| operation  | Elemento Operation | Operation   |

# Elementos Operation

| token           | md5 de la petici√≥n          | String (32) |
|-----------------|-----------------------------|-------------|
| shop_process_id | identificador de la compra. | Entero (15) |

![](_page_9_Picture_13.jpeg)

![](_page_10_Picture_0.jpeg)

| amount           | Importe en guaran√≠es.                                                                                                                                    | Decimal (15,2)<br>-<br>separador decimal '.' |
|------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
| iva_amount       | Importe en guaran√≠es.<br>Este par√°metro aplica solo<br>para aquellos comercios que<br>deben cumplir con la "Ley de<br>servicios digitales"               | Decimal (15,2)<br>-<br>separador decimal '.' |
| currency         | Tipo de Moneda.                                                                                                                                          | String (3) -<br>PYG (Gs)                     |
| additional_data  | Campo<br>de<br>servicio<br>de<br>uso<br>reservado para casos especiales.<br>Opcional                                                                     | String (100)                                 |
| preauthorization | Campo opcional para indicar que<br>es una preautorizacion                                                                                                | String (1) : S                               |
| description      | Descripci√≥n del pago, para<br>mostrar al usuario.                                                                                                        | String (20)                                  |
| return_url       | URL a donde se enviar√° al<br>usuario al realizar el pago. Tener<br>en cuenta que, si la tarjeta es<br>rechazada, tambi√©n se le<br>redirigir√° a esta URL. | String (255)                                 |
| cancel_url       | URL a donde se enviar√° al<br>usuario al cancelar el pago.<br>Opcional, se usar√° return_url<br>por defecto.                                               | String (255)                                 |

![](_page_10_Picture_2.jpeg)

![](_page_11_Picture_0.jpeg)

| extra_response_attributes | Par√°metros para recibir datos<br>extras en la respuesta del<br>servicio. |                                                                                           |
|---------------------------|--------------------------------------------------------------------------|-------------------------------------------------------------------------------------------|
|                           |                                                                          | Devuelve "credit" o "debit".<br>debit: Es una tarjeta de d√©bito<br>procesada por Bancard. |
|                           |                                                                          | credit: Es una tarjeta de cr√©dito<br>o una tarjeta no procesada por<br>Bancard.           |
| billing                   | Campo reservado para enviar<br>informaci√≥n de facturaci√≥n.<br>Opcional   | Billing                                                                                   |

# Descripci√≥n de "additional\_data"

Este elemento ser√° utilizado para enviar informaci√≥n adicional a validar en el momento de la autorizaci√≥n de la compra. Se emplear√° para indicar promociones o convenios realizados entre el comercio, Bancard y el emisor.

La estructura de este elemento ser√°:

| Dato     | Tipo de<br>Dato | Formato                                | Posici√≥n | Alcance | Ejemplo |
|----------|-----------------|----------------------------------------|----------|---------|---------|
| Entidad  | Int (3)         | Rellenado con ceros a la<br>izquierda  | 1-3      | TC y TD | 099     |
| Marca    | String (3)      | Rellenado con espacios a la<br>derecha | 4-6      | TC y TD | 'VS'    |
| Producto | String (3)      | Rellenado con espacios a la<br>derecha | 7-9      | TC y TD | 'ORO'   |

![](_page_11_Picture_6.jpeg)

![](_page_12_Picture_0.jpeg)

| Afinidad | Int (6) | Rellenado con ceros a la<br>izquierda | 10-15 | TC | 000045 |
|----------|---------|---------------------------------------|-------|----|--------|
|----------|---------|---------------------------------------|-------|----|--------|

Ejemplo de datos a enviar si el comercio desea validar que:

- . la tarjeta sea de una entidad espec√≠fica: 099
- . la tarjeta sea de una entidad y afinidad espec√≠fica: 099 000045
- . la tarjeta sea de una entidad y marca espec√≠fica: 099VS
- . la tarjeta sea de una entidad, marca y producto espec√≠fico: 099VS ORO
- . la tarjeta sea de una marca espec√≠fica: 000VS

.se puede enviar varias promociones: 099VS ORO000045,099VS,099VS ORO000045 \*entre comas(,) sin espacio

### Consideraciones a tener en cuenta para integrar Factura Electr√≥nica

- El comercio debe estar habilitado para emitir Factura Electr√≥nica.
- El campo del Timbrado (commerce\_stamp) debe ser v√°lido.
- Los campos de Establecimiento (commerce\_establishment) y Punto de Expedici√≥n (commerce\_expedition\_point) deben corresponder al Timbrado enviado.
- Si el valor del RUC del cliente (client\_ruc) es distinto a nulo o vac√≠o, los valores del nombre (client\_name) y correo electr√≥nico (client\_email) tambi√©n deben ser distinto a nulo o vac√≠o.
- Si el valor del RUC del cliente (client\_ruc) es igual a nulo o vac√≠o, se considerar√° como una Factura Innominada.
- Las facturas innominadas solo pueden ser generadas hasta un valor de Gs 7.000.000, seg√∫n reglamentaci√≥n de la DNIT.
- La lista de √≠tems adquiridos (details) no puede estar vac√≠a.
- El costo total de los √≠tems en operation.billing.details debe coincidir con el monto enviado en operation.amount.
- La factura electr√≥nica ser√° emitida si y solo si los datos de facturaci√≥n enviados son v√°lidos y el pago ha sido confirmado correctamente.
- En el flujo de pre-autorizacion, la factura electr√≥nica se genera luego de la confirmaci√≥n de la transacci√≥n.
- En caso de que los datos de facturaci√≥n enviados no sean v√°lidos, se emitir√° un mensaje de error detallando el problema, y no se procesar√° el pago.

![](_page_12_Picture_21.jpeg)

![](_page_13_Picture_0.jpeg)

- En caso de que los datos de facturaci√≥n sean v√°lidos, el pago se procese sin inconvenientes, pero la factura electr√≥nica no se haya podido generar correctamente, se emitir√° un mensaje detallando el problema con la facturaci√≥n en el campo billing\_response. El pago se mantendr√° en estado procesado.
- Los datos de todas las facturas electr√≥nicas emitidas estar√°n disponibles en el portal de facturaci√≥n electr√≥nica para ser consultadas.
- Si ha ocurrido un problema con la facturaci√≥n, el comercio tendr√° la opci√≥n de volver a generar la factura desde el portal de facturaci√≥n electr√≥nica.

# Descripci√≥n de elemento Billing

Este elemento ser√° utilizado para enviar la informaci√≥n de facturaci√≥n del comercio. Los datos recibidos ser√°n utilizados para emitir una factura electr√≥nica, si es que el comercio est√° habilitado para hacerlo. Debe tener en cuenta ciertas consideraciones para la integraci√≥n correcta de este elemento.

La estructura de este elemento ser√°:

| client_ruc                | RUC del Cliente                      | String (15)<br>Obs: Si se env√≠a null se emitir√°<br>una factura innominada |  |
|---------------------------|--------------------------------------|---------------------------------------------------------------------------|--|
| client_name               | Nombre o Raz√≥n Social del<br>Cliente | String (100)                                                              |  |
| client_email              | Correo electr√≥nico del Cliente       | String (32)                                                               |  |
| commerce_stamp            | Timbrado                             | String (32)                                                               |  |
| commerce_expedition_point | Punto de Expedici√≥n                  | String (32)                                                               |  |
| commerce_establishment    | Establecimiento                      | String (32)                                                               |  |

![](_page_13_Picture_8.jpeg)

![](_page_14_Picture_0.jpeg)

Elemento Details:

| description | Descripci√≥n<br>del articulo<br>adquirido  | String (255)                                 |
|-------------|-------------------------------------------|----------------------------------------------|
| amount      | Precio unitario del articulo<br>adquirido | Decimal (15,2)<br>-<br>separador decimal '.' |
| iva_rate    | Tasa de IVA aplicada al<br>producto.      | Entero (15)                                  |
| total_items | Cantidad del mismo art√≠culo<br>adquirido  | Entero (15)                                  |

**Ejemplo petici√≥n**:

| {                                              |
|------------------------------------------------|
| "public_key": "[public key]",                  |
| "operation": {                                 |
| "token": "[generated token]",                  |
| "shop_process_id": 54322,                      |
| "currency": "PYG",                             |
| "amount": "10330.00",                          |
| "iva_amount": "1033.00",                       |
| "additional_data": "099VS ORO000045",          |
| "description": "Ejemplo de pago",              |
| "return_url": "http://www.example.com/finish", |
| "cancel_url": "http://www.example.com/cancel", |
| "billing": {                                   |
| "client_ruc": "123456-1",                      |
| "client_name": "JUAN GONZALEZ",                |
| "client_email": "juangonzalez@mail.com.py",    |
| "commerce_stamp": "12559969",                  |
| "commerce_expedition_point": "001",            |
| "commerce_establishment": "002",               |
| "details": [                                   |
|                                                |

![](_page_14_Picture_6.jpeg)

![](_page_15_Picture_0.jpeg)

|   |   |   |   | {<br>}, | "description": "item 1",<br>"amount": "10000.00",<br>"iva_rate": 10,<br>"total_items": 1 |
|---|---|---|---|---------|------------------------------------------------------------------------------------------|
|   |   |   |   | {       | "description": "item 2",<br>"amount": "330.00",<br>"iva_rate": 10,<br>"total_items": 1   |
| } | } | } | ] | }       |                                                                                          |

**La respuesta estar√° compuesta por un JSON con los siguientes elementos:** 

| status     | Estado de respuesta        | String (20) |
|------------|----------------------------|-------------|
| process_id | Identificador de la compra | String (20) |

# **Ejemplo respuesta:**

}

{ "status": "success", "process\_id": "i5fn\*lx6niQel0QzWK1g"

**Nota:** 

![](_page_16_Picture_0.jpeg)

"El mensaje de respuesta se enviar√° en el cuerpo (body) de la petici√≥n HTTP"

# *Invocar al iframe de pago ocasional*

Una vez obtenido el **process\_id en la operaci√≥n de single\_buy**, el usuario podr√° incluir en su e-commerce un formulario de checkout embebido, de esta forma la compra se podr√° finalizar en su propia aplicaci√≥n. Para esto podr√° utilizar la librer√≠a JavaScript como se indica en el siguient[e](https://github.com/Bancard/bancard-checkout-js) [repositorio de](https://github.com/Bancard/bancard-checkout-js) [c√≥digo.](https://github.com/Bancard/bancard-checkout-js) https://github.com/Bancard/bancard-checkout-js

El JavaScript para iframe de pago ocasional se encuentra publicado:

# src="**https://{enviroment}/checkout/javascript/dist/bancard-checkout-4.0.0.js">**

Environment

- **Producci√≥n**  https://vpos.infonet.com.py
- **Staging**  https://vpos.infonet.com.py:8888

```
Para levantar el iframe:
 window. onload = function () 
           {
```

Bancard.Checkout. createForm ('iframe-container', **process\_id** ', styles);

};

<span id="page-16-0"></span>Ejemplo de c√≥digo html

![](_page_16_Picture_13.jpeg)

![](_page_17_Picture_0.jpeg)

| DOCTYPE html                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <html lang="en"></html>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <head></head>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <meta charset="utf-8"/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <title>iFrame</title>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <script src="https://vpos.infonet.com.py:8888/checkout/javascript/dist/bancard&lt;br&gt;checkout-1.0.0.js"></script>                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <script type="application/javascript"> styles = {</td></tr><tr><td>"form-background-color": "#001b60",</td></tr><tr><td>"button-background-color": "#4faed1",</td></tr><tr><td>"button-text-color": "#fcfcfc",</td></tr><tr><td>"button-border-color": "#dddddd",</td></tr><tr><td>"input-background-color": "#fcfcfc",</td></tr><tr><td>"input-text-color": "#111111",</td></tr><tr><td>"input-placeholder-color": "#111111"</td></tr><tr><td>};<br>window. onload = function () {<br>Bancard.Checkout.createForm ('iframe-container', 'WR-YY9JmxsEZV3hpVGA7', styles);<br>};<br></script><br> |

# Panel de personalizaci√≥n

Pueden personalizar el iframe tambi√©n por medio de una tabla de personalizaci√≥n que se encuentra en el panel de vpos del portal de comercio en el apartado de Perfil de la aplicaci√≥n.

![](_page_17_Picture_4.jpeg)

![](_page_18_Picture_0.jpeg)

| Atributo                       | Valor                        |
|--------------------------------|------------------------------|
| Color fondo de campos          |                              |
| Color texto de campos          |                              |
| Color borde de campos          | $\qquad \qquad \blacksquare$ |
| Color fondo del bot√≥n          |                              |
| Color texto del bot√≥n          |                              |
| Color borde del bot√≥n          |                              |
| Color fondo de formulario      |                              |
| Color del borde del formulario | $\qquad \qquad \blacksquare$ |
| Color fondo de encabezado      |                              |
| Color texto de encabezado      |                              |
| Color de l√≠nea separadora      |                              |
| Color del placeholder          |                              |
| Color texto de tu-eres-tu      |                              |

**Luego de que el usuario ingrese los datos de su tarjeta y le da al bot√≥n de PAGAR, entonces el vpos realiza un POST a la url de confirmaci√≥n que el comercio proporciono en el panel de la aplicaci√≥n.** 

Es la siguiente operaci√≥n: Operaci√≥n de confirmaci√≥n

Experiencia de compra de un cliente en un sitio con el **iframe de pago ocasional**

![](_page_18_Picture_6.jpeg)

![](_page_19_Picture_0.jpeg)

![](_page_19_Picture_2.jpeg)

![](_page_19_Picture_4.jpeg)

![](_page_19_Picture_5.jpeg)

![](_page_19_Figure_7.jpeg)

# <span id="page-19-0"></span>**Single Buy Zimple (Pedido de pago con Zimple)**

**POST** {environment}/vpos/api/0.3/single\_buy

Environment:

- Producci√≥n https://vpos.infonet.com.py
- Staging https://vpos.infonet.com.py:8888

Token: md5(private\_key + shop\_process\_id + amount + currency)

Operaci√≥n invocada por el comercio para iniciar el proceso de pago por zimple. Es el mismo servicio que se utiliza para el pago ocasional.

Este servicio devolver√° un identificador de proceso (process id) que se utilizar√° para invocar el iframe de zimple. Llamamos **iframe de pago zimple** al iframe que permite cargar el formulario en el sitio del comercio.

Obs: Si tiene implementado el pago ocasional, para implementar **Zimple**, solo tiene 2 variantes, el **additional\_data** y el campo **zimple**.

**El pedido estar√° compuesto por un JSON con los siguientes elementos:** 

![](_page_19_Picture_18.jpeg)

![](_page_20_Picture_0.jpeg)

### Elementos de la petici√≥n

| public_key | Clave p√∫blica.     | String (50) |
|------------|--------------------|-------------|
| operation  | Elemento Operation | Operation   |

#### Elementos Operation

| token           | md5 de la petici√≥n                                             | String (32)                                  |
|-----------------|----------------------------------------------------------------|----------------------------------------------|
| shop_process_id | identificador de la compra.                                    | Entero (15)                                  |
| amount          | Importe en guaran√≠es.                                          | Decimal (15,2)<br>-<br>separador decimal '.' |
| currency        | Tipo de Moneda.                                                | String (3) -<br>PYG (Gs)                     |
|                 |                                                                |                                              |
| additional_data | Campo donde ira el tel√©fono<br>celular del usuario con Zimple. | String (100)<br>Ej: "0981123456"             |
| description     | Descripci√≥n del pago, para<br>mostrar al usuario.              | String (20)                                  |

![](_page_20_Picture_5.jpeg)

![](_page_21_Picture_0.jpeg)

| cancel_url | URL a donde se enviar√° al<br>usuario al cancelar el pago.<br>Opcional, se usar√° return_url<br>por defecto. | String (255) |
|------------|------------------------------------------------------------------------------------------------------------|--------------|
| billing    | Campo reservado para enviar<br>informaci√≥n de facturaci√≥n.<br>Opcional                                     | Billing      |

| zimple | Valor que enviar cuando se<br>quiere invocar el iframe de<br>simple, enviar "S" | String (1) Ej: "S" |
|--------|---------------------------------------------------------------------------------|--------------------|
|        |                                                                                 |                    |

# Descripci√≥n de elemento Billing

Este elemento ser√° utilizado para enviar la informaci√≥n de facturaci√≥n del comercio. Los datos recibidos ser√°n utilizados para emitir una factura electr√≥nica, si es que el comercio est√° habilitado para hacerlo. Debe tener en cuenta ciertas consideraciones para la integraci√≥n correcta de este elemento.

La estructura de este elemento ser√°:

| client_ruc     | RUC del Cliente                      | String (15)<br>Obs: Si se env√≠a null se emitir√°<br>una factura innominada |
|----------------|--------------------------------------|---------------------------------------------------------------------------|
| client_name    | Nombre o Raz√≥n Social del<br>Cliente | String (100)                                                              |
| client_email   | Correo electr√≥nico del Cliente       | String (32)                                                               |
| commerce_stamp | Timbrado                             | String (32)                                                               |

![](_page_21_Picture_7.jpeg)

![](_page_22_Picture_0.jpeg)

| commerce_expedition_point | Punto de Expedici√≥n          | String (32)      |
|---------------------------|------------------------------|------------------|
|                           |                              |                  |
| commerce_establishment    | Establecimiento              | String (32)      |
|                           |                              |                  |
| details                   | Detalles de √≠tems adquiridos | Array de Details |
|                           |                              |                  |

#### Elemento Details:

| description | Descripci√≥n del articulo<br>adquirido     | String (255)                                 |
|-------------|-------------------------------------------|----------------------------------------------|
| amount      | Precio unitario del articulo<br>adquirido | Decimal (15,2)<br>-<br>separador decimal '.' |
| iva_rate    | Tasa de IVA aplicada al<br>producto.      | Entero (15)                                  |
| total_items | Cantidad del mismo art√≠culo<br>adquirido  | Entero (15)                                  |

**Ejemplo petici√≥n:**

![](_page_22_Picture_5.jpeg)

![](_page_23_Picture_0.jpeg)

```
{
 "public_key": "[public key]",
 "operation": {
 "token": "[generated token]",
 "shop_process_id": 54322,
 "currency": "PYG",
 "amount": "10330.00",
 "additional_data": "0981123456",
 "description": "Ejemplo de pago",
 "return_url": "http://www.example.com/finish",
 "cancel_url": "http://www.example.com/cancel",
 "zimple": "S",
 "billing": {
 "client_ruc": "123456-1",
 "client_name": "JUAN GONZALEZ",
 "client_email": "juangonzalez@mail.com.py",
 "commerce_stamp": "12559969",
 "commerce_expedition_point": "001",
 "commerce_establishment": "002",
 "details": [
 {
 "description": "item 1",
 "amount": "10000.00",
 "iva_rate": 10,
 "total_items": 1
 },
 {
 "description": "item 2",
 "amount": "330.00",
 "iva_rate": 10,
 "total_items": 1
 }
 ]
 }
 }
}
```

**La respuesta estar√° compuesta por un JSON con los siguientes elementos:** 

![](_page_23_Picture_3.jpeg)

![](_page_24_Picture_0.jpeg)

| status     | Estado de respuesta        | String (20) |
|------------|----------------------------|-------------|
| process_id | Identificador de la compra | String (20) |

### **Ejemplo respuesta:**

```
{ 
"status": "success", 
"process_id": "i5fn*lx6niQel0QzWK1g" 
}
```

#### **Nota:**

"El mensaje de respuesta se enviar√° en el cuerpo (body) de la petici√≥n HTTP"

# *Invocar al iframe de pago con zimple*

Una vez obtenido el **process\_id**, el usuario podr√° incluir en su e-commerce un formulario de checkout embebido, de esta forma la compra se podr√° finalizar en su propia aplicaci√≥n.

El JavaScript para iframe de pago con zimple se encuentra publicado:

```
src="https://{enviroment}/checkout/javascript/dist/bancard-checkout-3.0.0.js">
```

Environment

- Producci√≥n https://vpos.infonet.com.py
- Staging https://vpos.infonet.com.py:8888

# Para levantar el iframe:

```
window. onload = function () {
```

Bancard.Zimple.createForm ('iframe-container', **process\_id** ', styles);

};

[Ejemplo de c√≥digo html](#page-16-0) [Ejemplo de c√≥digo html](#page-16-0)

![](_page_24_Picture_18.jpeg)

![](_page_25_Picture_0.jpeg)

### **Ejemplo de iframe Zimple**

![](_page_25_Picture_2.jpeg)

#### **Flujo para pago con Zimple**

- Enviar el pedido de single\_buy con las variantes para Zimple.
- El servicio enviar√° un c√≥digo al tel√©fono cargado en el campo additional\_data.
- Levantar el iframe Zimple.
- El usuario debe cargar el c√≥digo que llego a su tel√©fono en el iframe.
- Al confirmar el pago se debitar√° de su billetera Zimple.

# **Obs: El tel√©fono de prueba es 0981123456 y el c√≥digo OTP para las pruebas es 1234 para una transaccion aprobada.**

**Luego de que el usuario ingrese los datos de su tarjeta y le da al bot√≥n de PAGAR, entonces el vpos realiza un POST a la url de confirmaci√≥n que el comercio proporciono en el panel de la aplicaci√≥n.** 

Es la siguiente operaci√≥n: Buy Single [Confirm \(Operaci√≥n de confirmaci√≥n de una transaccion\)](#page-42-1)

# <span id="page-25-0"></span>**Catastro y Pago con token**

Esta es una opci√≥n totalmente nueva para el comercio, donde se puede catastrar una tarjeta y realizar el pago con el token generado en el catastro.

Vpos 2.0 contar√° con la opci√≥n de catastro de tarjetas dentro de un **iframe de catastro** siempre en el ambiente seguro de Bancard cumpliendo con las normas PCI.

Tarjetas procesadas

Esta operaci√≥n acepta:

![](_page_25_Picture_17.jpeg)

![](_page_26_Picture_0.jpeg)

- Tarjetas de cr√©dito local/internacional.
- Tarjeta de d√©bito local/internacional.

#### Arquitectura planteada

Se plantea un e-commerce gen√©rico con un backend (Commerce Backend), frontend web (Commerce Web App) y mobile (Commerce Mobile App). Los comercios pueden acceder a la API Rest de vPOS (vPOS Service) y al portal de vPOS (vPOS Portal) ambos dos instalados en Bancard cumpliendo las normas PCI.

![](_page_26_Figure_5.jpeg)

#### <span id="page-26-0"></span>**Operaciones para catastro y pago con token**

### <span id="page-26-1"></span>**Catastro de Tarjeta (Cards\_new)**

**POST** {environment}/vpos/api/0.3/cards/new

Environment:

- **Producci√≥n**  https://vpos.infonet.com.py
- **Staging**  https://vpos.infonet.com.py:8888

![](_page_26_Picture_12.jpeg)

![](_page_27_Picture_0.jpeg)

Token:

md5(private\_key + card\_id + user\_id + "request\_new\_card")

Operaci√≥n invocada por el comercio para iniciar el proceso de catastro.

Este servicio devolver√° un identificador de proceso (process id) que se utilizar√° para invocar el iframe de catastro. Llamamos **iframe de catastro** al iframe que permite generar un token de tarjeta para pagos con un click.

**Debe completarse con √©xito un Cards\_new para habilitaci√≥n de la correspondiente opci√≥n en la Lista de test -> Solicitud de catastro**

Obs: No se marcar√° en la lista de test si es que en el json del pedido env√≠an test\_client.

## **El pedido estar√° compuesto por un JSON con los siguientes elementos:**

Elementos de la petici√≥n

| public_key | Clave p√∫blica.     | String (50) |
|------------|--------------------|-------------|
| operation  | Elemento Operation | Operation   |

### Elementos Operation

| token           | md5 de la petici√≥n                         | String (32)  |
|-----------------|--------------------------------------------|--------------|
| card_id         | identificador de la tarjeta del<br>usuario | Entero (19)  |
| user_id         | Identificador del usuario                  | Entero (19)  |
| user_cell_phone | Tel√©fono del usuario                       | String (255) |

![](_page_27_Picture_12.jpeg)

![](_page_28_Picture_0.jpeg)

| user_mail  | Mail del usuario                                                                                                                                         | String (255) |
|------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| return_url | URL a donde se enviar√° al<br>usuario al realizar el pago. Tener<br>en cuenta que, si la tarjeta es<br>rechazada, tambi√©n se le<br>redirigir√° a esta URL. | String (255) |

**Los atributos card\_id, user\_id, user\_cell\_phone y user\_mail son obligatorios y son brindados para asociar el pedido de catastro de tarjeta a un usuario con una referencia interna del comercio.** 

**Un usuario del comercio(user\_id) pueden tener N tarjetas asociadas(card\_id).** 

### **Ejemplo petici√≥n:**

![](_page_28_Picture_5.jpeg)

**La respuesta estar√° compuesta por un JSON con los siguientes elementos:** 

![](_page_28_Picture_7.jpeg)

![](_page_29_Picture_0.jpeg)

| status     | Estado de respuesta        | String (20) |
|------------|----------------------------|-------------|
| process_id | Identificador de la compra | String (20) |

### **Ejemplo respuesta:**

{ "status": "success", "process\_id": "i5fn\*lx6niQel0QzWK1g" }

**Obs: Tener en cuenta que el servicio podr√≠a devolver alg√∫n dato adicional a futuro.**

### *Invocar al iframe de catastro de tarjeta*

El usuario podr√° embeber dentro de su propio sitio o app un formulario para el ingreso de informaci√≥n sensible de tarjetas.

Una vez que se tiene el process\_id los pasos para realizar la integraci√≥n son:

- 1. Incluir bancard-checkout.js
- 2. Iniciar contenedor con c√≥digo JavaScript

# *1. Incluir bancard-checkout.js*

Para utilizar la librer√≠a *bancard-checkout.js* se debe incluir la misma utilizando, por ejemplo, el siguiente c√≥digo:

El JavaScript para iframe de catastro se encuentra publicado:

https://github.com/Bancard/bancard-checkout-js

src="**https://{enviroment}/checkout/javascript/dist/bancard-checkout-4.0.0.js**">

Environment

- **Producci√≥n**  https://vpos.infonet.com.py
- **Staging**  https://vpos.infonet.com.py:8888

# *2. Iniciar contenedor con c√≥digo JavaScript*

![](_page_29_Picture_19.jpeg)

![](_page_30_Picture_0.jpeg)

Para montar el formulario de catastro en el sitio web, se debe ejecutar Bancard.Cards.createForm indicando el id del contenedor, process\_id y un conjunto de opciones que incluyen los estilos asociados al elemento embebido.

Ejemplo de invocaci√≥n:

window. onload = function () { Bancard.Cards.createForm('iframe-container','[PROCESS\_ID]', styles); };

[Ejemplo de c√≥digo html](#page-16-0)

### *Recomendaci√≥n para aplicativos que implementen catastro de tarjetas*

Para comercios que implementen en su aplicativo Android tener en cuenta que para implementar el iframe se tiene que agregar las siguientes l√≠neas de c√≥digo.

CookieSyncManager.getInstance().startSync();

CookieManager cookieManager = CookieManager.getInstance();

cookieManager.setAcceptCookie(true);

CookieManager.getInstance().setAcceptThirdPartyCookies(registrarTarjetaWebView, true);

Esto es porque para el iframe necesitamos en algunas situaciones aceptar cookies y si no se tiene seteado para aceptarlas entonces el aplicativo rechaza.

Obs1: En IOS aplicativos no existe ese inconveniente.

Obs2: En Safari a partir de cierta versi√≥n se controla mediante una opci√≥n ("Prevent cross-site tracking.") que no se pueda setear cookies desde un iFrame, en el navegador se encuentra esa opci√≥n, si desmarcan eso de su navegador ya no se da el inconveniente. Chrome tambi√©n tiene esa opci√≥n, pero no viene marcado por defecto.

# **Flujo de catastro**

# **Para el catastro con tarjeta de cr√©dito:**

- Se cargan los datos de la tarjeta (nro., fecha de expiraci√≥n, cvv) - Se carga cedula

# **Para el catastro con tarjeta de d√©bito:**

![](_page_30_Picture_18.jpeg)

![](_page_31_Picture_0.jpeg)

- Se cargan los datos de la tarjeta (no, fecha de expiraci√≥n, dato adicional) - Se carga cedula

Al momento de levantar el iframe, les aparece la opci√≥n de cargar los datos de la tarjeta y al dar siguiente les pedir√° cargar un numero de cedula valido.

La cedula v√°lida para las tarjetas es: 9661000 (Para las pruebas)

# **Mensajes de respuesta del iframe de catastro**

- El mensaje del iframe si se cargan correctamente los datos de la tarjeta:

{ "status": " add\_new\_card\_success ", "description": null }

- El mensaje del iframe si no se carga correctamente los datos:

{ "status": " add\_new\_card\_fail ", "description": "No se ha catastrado la tarjeta. Para continuar con el catastro favor comun√≠quese con el CAC de Bancard. \*288/4161000" }

<span id="page-31-0"></span>**Recuperar Tarjetas catastradas de un usuario (users\_cards) POST** {environment}/vpos/api/0.3/users/**user\_id**/cards

Environment:

- **Producci√≥n**  https://vpos.infonet.com.py
- **Staging**  https://vpos.infonet.com.py:8888

Token:

md5(private\_key + user\_id + "request\_user\_cards")

![](_page_31_Picture_19.jpeg)

![](_page_32_Picture_0.jpeg)

**Operaci√≥n invocada por el comercio para obtener las tarjetas catastradas de un usuario.** 

**Debe completarse con √©xito un users\_cards para habilitaci√≥n de la correspondiente opci√≥n en la Lista de test -> Recibir tarjetas del usuario**

Obs: No se marcar√° en la lista de test si es que en el json del pedido env√≠an test\_client.

## **El pedido estar√° compuesto por un JSON con los siguientes elementos:**

#### Elementos de la petici√≥n

| public_key | Clave p√∫blica.     | String (50) |
|------------|--------------------|-------------|
| operation  | Elemento Operation | Operation   |

#### Elementos Operation

| token                     | md5 de la petici√≥n                                                   | String (32)                                                                                                                                                                                                                                                           |
|---------------------------|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| extra_response_attributes | Par√°metros para recibir<br>datos extras en el listado<br>de tarjetas | Array de par√°metros: par√°metros a<br>enviar: cards.bancard_proccesed<br>Ej: ["cards.bancard_proccesed"]<br>Devuelve true o false:<br>True: Es una tarjeta procesada por<br>Bancard<br>False: No es una tarjeta procesada por<br>Bancard(intracountry/internacionales) |

El **user\_id** debe ser el mismo que el comercio ingres√≥ en la operaci√≥n anterior (POST cards/new)

# **Ejemplo petici√≥n:**

![](_page_32_Picture_11.jpeg)

![](_page_33_Picture_0.jpeg)

| { |                                                                                                           |
|---|-----------------------------------------------------------------------------------------------------------|
|   | "public_key": "kR6oAQoIYCqUZLAivLQgac3lO7mv5bXZ",                                                         |
|   | "operation": {                                                                                            |
|   | "token": "69bd9ef382cb47e796ebe9f6b6b850ba" ,<br>"extra_response_attributes": ["cards.bancard_proccesed"] |
|   | }                                                                                                         |
| } |                                                                                                           |

### **La respuesta estar√° compuesta por un JSON con los siguientes elementos:**

| status | Estado de respuesta | String (20) |
|--------|---------------------|-------------|
| cards  | Elemento cards      | Cards []    |

#### Array cards []

| alias_token        | Alias token temporal para<br>realizar el pago | String (255) |
|--------------------|-----------------------------------------------|--------------|
| card_masked_number | Tarjeta enmascarada                           | String (255) |
| expiration_date    | Fecha espiraci√≥n de la tarjeta                | String (255) |
| card_brand         | Marca de la tarjeta                           | String (255) |
| card_id            | Identificador de la tarjeta                   | String (255) |

| card_type | Tipo de la tarjeta (credit o debit) | String (20) |
|-----------|-------------------------------------|-------------|
|           |                                     |             |

![](_page_33_Picture_7.jpeg)

![](_page_34_Picture_0.jpeg)

### **Ejemplo respuesta:**

```
{ 
"status": "success" 
"cards": [{ 
"alias_token": "c8996fb92427ae41e4649b934ca495991b7852b855", 
"card_masked_number": "5418********0014", 
"expiration_date": "08/21", 
"card_brand": "MasterCard", 
"card_id": 1 ,
"bancard_proccessed": "true"
}...] 
}
```

El **alias\_token** retornado permite realizar pagos con la tarjeta catastrada con la operaci√≥n [Pago con](#page-34-0)  [token\(charge\).](#page-34-0)

Es importante destacar, que el token tiene validez para una sola operaci√≥n y su tiempo de vida (ttl) es del orden de los minutos.

**Obs: Tener en cuenta que el servicio podr√≠a devolver alg√∫n dato adicional a futuro.** 

<span id="page-34-0"></span>**Pago con token(charge)**

**POST** {environment}/vpos/api/0.3/charge

Environment

![](_page_35_Picture_0.jpeg)

- **Producci√≥n**  https://vpos.infonet.com.py
- **Staging**  https://vpos.infonet.com.py:8888

#### Token:

md5(private\_key + shop\_process\_id + "charge" + amount + currency + alias\_token)

El comercio podr√° establecer un cargo luego de obtener las tarjetas de un usuario, para esto deber√° invocar a esta operaci√≥n de charge.

**Debe completarse con √©xito un Charge para habilitaci√≥n de la correspondiente opci√≥n en la Lista de test -> Pago con alias token**

Obs: No se marcar√° en la lista de test si es que en el json del pedido env√≠an test\_client.

#### **El pedido estar√° compuesto por un JSON con los siguientes elementos:**

#### Elementos de la petici√≥n

| public_key | Clave p√∫blica.     | String (50) |
|------------|--------------------|-------------|
| operation  | Elemento Operation | Operation   |

Elementos Operation

| token           | md5 de la petici√≥n                                                                                                                         | String (32)                                  |
|-----------------|--------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
| shop_process_id | identificador de la compra.                                                                                                                | Entero (15)                                  |
| amount          | Importe en guaran√≠es.                                                                                                                      | Decimal (15,2)<br>-<br>separador decimal '.' |
| iva_amount      | Importe en guaran√≠es.<br>Este par√°metro aplica solo<br>para aquellos comercios que<br>deben cumplir con la "Ley de<br>servicios digitales" | Decimal (15,2)<br>-<br>separador decimal '.' |

![](_page_35_Picture_13.jpeg)

![](_page_36_Picture_0.jpeg)

| currency           | Tipo de Moneda.    | String (3) -<br>PYG (Gs)                                                                                                                                                                                                                                                                                                                                                           |
|--------------------|--------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| number_of_payments | Cantidad de cuotas | -Debito:<br>siempre deben enviar<br>1, ya que cuotas no aplica para<br>d√©bito.<br>-Cr√©dito:<br>el comercio puede<br>implementar un combo box<br>donde<br>el<br>usuario<br>elija<br>la<br>cantidad de cuotas a pagar,<br>esto financia la entidad de la<br>tarjeta del usuario, al comercio<br>siempre le llega el monto total.<br>Si env√≠a 1 es que se realiza en<br>un solo pago. |

| additional_data           | Campo<br>de<br>servicio<br>de<br>uso<br>reservado para casos especiales.<br>Opcional                                                                                       | String (100)                                                                                            |
|---------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------|
| preauthorization          | Campo opcional para indicar que<br>es una preautorizacion                                                                                                                  | String (1) : S                                                                                          |
| Alias_token               | alias<br>token<br>obtenido<br>de<br>la<br>operaci√≥n de recuperar tarjetas                                                                                                  | String (255)                                                                                            |
| extra_response_attributes | Par√°metros<br>para<br>recibir<br>dato<br>para el flujo de 3DS.<br>Siempre enviar este dato                                                                                 | Array de par√°metros: par√°metros<br>a enviar: confirmation.process_id<br>Ej: ["confirmation.process_id"] |
| Return_url                | URL a donde se enviar√° al usuario<br>al realizar el pago. Tener en<br>cuenta<br>que,<br>si la tarjeta<br>es<br>rechazada,<br>tambi√©n<br>se<br>le<br>redirigir√° a esta URL. | String (255)                                                                                            |
| billing                   | Campo reservado para enviar<br>informaci√≥n de facturaci√≥n.<br>Opcional                                                                                                     | Billing                                                                                                 |

Descripci√≥n de elemento Billing

![](_page_36_Picture_4.jpeg)

![](_page_37_Picture_0.jpeg)

Este elemento ser√° utilizado para enviar la informaci√≥n de facturaci√≥n del comercio. Los datos recibidos ser√°n utilizados para emitir una factura electr√≥nica, si es que el comercio est√° habilitado para hacerlo. Debe tener en cuenta ciertas consideraciones para la integraci√≥n correcta de este elemento.

La estructura de este elemento ser√°:

| client_ruc                | RUC del Cliente                      | String (15)<br>Obs: Si se env√≠a null se emitir√°<br>una factura innominada |
|---------------------------|--------------------------------------|---------------------------------------------------------------------------|
| client_name               | Nombre o Raz√≥n Social del<br>Cliente | String (100)                                                              |
| client_email              | Correo electr√≥nico del Cliente       | String (32)                                                               |
| commerce_stamp            | Timbrado                             | String (32)                                                               |
| commerce_expedition_point | Punto de Expedici√≥n                  | String (32)                                                               |
| commerce_establishment    | Establecimiento                      | String (32)                                                               |
| details                   | Detalles de √≠tems adquiridos         | Array de Details                                                          |

# Elemento Details:

| description | Descripci√≥n del articulo<br>adquirido     | String (255)                                 |
|-------------|-------------------------------------------|----------------------------------------------|
| amount      | Precio unitario del articulo<br>adquirido | Decimal (15,2)<br>-<br>separador decimal '.' |
| iva_rate    | Tasa de IVA aplicada al<br>producto.      | Entero (15)                                  |

![](_page_37_Picture_6.jpeg)

![](_page_38_Picture_0.jpeg)

# <span id="page-38-0"></span>**Flujo 3D SECURE Pago con token - Charge**

*Tener en cuenta que todos los comercios bajo el rubro "Casinos y juegos de azar" deber√°n enviar el CVV de la tarjeta para todas las transacciones. En caso de no hacerlo, se encuentra sujeto a multas por incumplimiento.*

# **Ejemplo petici√≥n:**

{

}

{

```
 "public_key": "kR6oAQoIYCqUZLAivLQgac3lO7mv5bXZ",
 "operation": {
 "token": "f9aa075da613ee2b62e6712c1ed537f2",
 "shop_process_id": 60361,
 "amount": "723215.00",
 "iva_amount": "723215.00",
 "number_of_payments": 1,
 "currency": "PYG",
 "additional_data": "",
 "description": "descripci√≥n 1",
 "return_url": "http://micomercio.com/resultado/pago3ds",
 "alias_token": "c8996fb92427ae41e4649b934ca495991b7852b855",
 "extra_response_attributes": [
 "confirmation.process_id"
 ]
 }
```

El alias\_token es el obtenido al recuperar la lista de tarjetas de un usuario bajo el atributo con el mismo nombre.

**Ejemplo respuesta:** La respuesta ya viene en el response del request. El tiempo de respuesta es en segundos.

```
 "operation": {
 "token": "[generated token]",
 "process_id": null, // este campo vendr√° null si no es un flujo 3DS
 "shop_process_id": "12313",
 "response": "S",
 "response_details": "respuesta S",
 "extended_response_description": "respuesta extendida",
 "currency": "PYG",
 "amount": 10100,
 "authorization_number": "123456",
 "ticket_number": "123456789123456",
 "iva_amount": "1100.0",
 "iva_ticket_number": "2117960079",
 "response_code": "00",
 "response_description": "Transacci√≥n aprobada.",
```

![](_page_38_Picture_11.jpeg)

![](_page_39_Picture_0.jpeg)

```
 "security_information": {
 "customer_ip": "123.123.123.123",
 "card_source": "I",
 "card_country": "Croacia",
 "version": "0.3",
 "risk_index": "0"
 }
```

 } }

**Ejemplo respuesta para flujo 3DS:** El flujo de 3ds devolver√° todos los datos vac√≠os y devolver√° un campo extra que es process\_id para poder levantar un iframe

| {                                                                                       |  |
|-----------------------------------------------------------------------------------------|--|
| "operation": {                                                                          |  |
| "token": null,                                                                          |  |
| "process_id": "i5fn*lx6niQel0QzWK1g", //en este campo vendr√° un dato si es un flujo 3DS |  |
| "shop_process_id": null,                                                                |  |
| "response": null,                                                                       |  |
| "response_details": null,                                                               |  |
| "extended_response_description": null,                                                  |  |
| "currency": null,                                                                       |  |
| "amount": null,                                                                         |  |
| "authorization_number": null,                                                           |  |
| "ticket_number": null,                                                                  |  |
| "iva_amount": null,                                                                     |  |
| "iva_ticket_number": null,                                                              |  |
| "response_code": null,                                                                  |  |
| "response_description": null,                                                           |  |
| "security_information": {                                                               |  |
| "customer_ip": null,                                                                    |  |
| "card_source": null,                                                                    |  |
| "card_country": null,                                                                   |  |
| "version": null,                                                                        |  |
| "risk_index": null                                                                      |  |
| }                                                                                       |  |
| }                                                                                       |  |
| }                                                                                       |  |
|                                                                                         |  |

### *Invocar al iframe de 3D SECURE*

El usuario podr√° embeber dentro de su propio sitio o app. Una vez que se tiene el process\_id los pasos para realizar la integraci√≥n son:

- 3. Incluir bancard-checkout.js
- 4. Iniciar contenedor con c√≥digo JavaScript

### *3. Incluir bancard-checkout.js*

Para utilizar la librer√≠a *bancard-checkout.js* se debe incluir la misma utilizando, por ejemplo, el siguiente c√≥digo:

![](_page_39_Picture_10.jpeg)

![](_page_40_Picture_0.jpeg)

El JavaScript para iframe de catastro se encuentra publicado:

https://github.com/Bancard/bancard-checkout-js

### src="**https://{enviroment}/checkout/javascript/dist/bancard-checkout-4.0.0.js**">

Environment

- **Producci√≥n**  https://vpos.infonet.com.py
- **Staging**  https://vpos.infonet.com.py:8888

#### *4. Iniciar contenedor con c√≥digo JavaScript*

Para montar el formulario de 3ds en el sitio web, se debe ejecutar Bancard.Charge3DS.createForm indicando el id del contenedor, process\_id y un conjunto de opciones que incluyen los estilos asociados al elemento embebido.

Ejemplo de invocaci√≥n:

window. onload = function () { Bancard.Charge3DS.createForm('iframe-container','[PROCESS\_ID]', styles); }; [Ejemplo de c√≥digo html](#page-16-0)

### *5. Luego que el iframe termine su flujo*

El comercio recibir√° un mensaje de success desde el iframe indicando que el flujo termino ok. Los detalles de la transaccion el comercio recibir√° en su url de confirmaci√≥n, as√≠ como el d√≠a de hoy ya lo recibe cuando se procesa un pago, m√°s informaci√≥n en la secci√≥n de [Buy Single Confirm \(Operaci√≥n de](#page-42-1)  [confirmaci√≥n de una transaccion\)](#page-42-1)

# <span id="page-40-0"></span>**Eliminar tarjeta**

**DELETE** {environment}/vpos/api/0.3/users/**user\_id**/cards

Environment

- **Producci√≥n**  https://vpos.infonet.com.py
- **Staging**  https://vpos.infonet.com.py:8888

Token:

md5(private\_key + "delete\_card" + user\_id + card\_token)

**Se podr√° eliminar una tarjeta a un usuario, para esto se deber√° invocar a la siguiente operaci√≥n.** 

**Debe completarse con √©xito un delete para habilitaci√≥n de la correspondiente opci√≥n en la Lista de test -> Eliminar tarjeta del usuario**

![](_page_40_Picture_22.jpeg)

![](_page_41_Picture_0.jpeg)

Obs: No se marcar√° en la lista de test si es que en el json del pedido env√≠an test\_client.

### **El pedido estar√° compuesto por un JSON con los siguientes elementos:**

#### Elementos de la petici√≥n

| public_key | Clave p√∫blica.     | String (50) |
|------------|--------------------|-------------|
| operation  | Elemento Operation | Operation   |

#### Elementos Operation

| token       | md5 de la petici√≥n                                                        | String (32)  |
|-------------|---------------------------------------------------------------------------|--------------|
| alias_token | alias<br>token<br>obtenido<br>de<br>la<br>operaci√≥n de recuperar tarjetas | String (255) |

Ejemplo petici√≥n:

![](_page_41_Figure_8.jpeg)

El alias\_token es el obtenido al recuperar la lista de tarjetas de un usuario bajo el atributo con el mismo nombre.

![](_page_41_Picture_10.jpeg)

![](_page_42_Picture_0.jpeg)

El **user\_id** debe ser el mismo que el comercio ingres√≥ en la operaci√≥n de recuperar las tarjetas.

#### **La respuesta estar√° compuesta por un JSON con los siguientes elementos:**

| status | Estado de respuesta | String (20) |
|--------|---------------------|-------------|
|        |                     |             |

#### Ejemplo respuesta:

| {                   |
|---------------------|
| "status": "success" |
| }                   |

#### **Obs: Tener en cuenta que el servicio podr√≠a devolver alg√∫n dato adicional a futuro.**

<span id="page-42-0"></span>**Operaciones comunes para pago ocasional y pago con token**

# <span id="page-42-1"></span>**Buy Single Confirm (Operaci√≥n de confirmaci√≥n de una transaccion)**

**POST** [URL] (Definida por el comercio)

Esta acci√≥n es invocada por VPOS al finalizar una transacci√≥n. Tiene como objetivo confirmar o

cancelar un pago. Este ser√° el √∫nico medio por el cual el cliente tendr√° la certeza de que el usuario

complet√≥ satisfactoriamente una transacci√≥n.

# **Bancard realizar√° una petici√≥n POST a la url de confirmaci√≥n que el comercio cargo en su panel de aplicaci√≥n de vpos en el portal de comercios, enviando el JSON en el cuerpo del pedido o body.**

El comercio deber√° responder con status 200 a la operaci√≥n, como se muestra m√°s abajo en el ejemplo de respuesta. Si el comercio no responde con status 200 dentro de los siguientes 30 segundos, vPOS cerrar√° la conexi√≥n y se marcar√° como inv√°lida la confirmaci√≥n en la traza y con una indicaci√≥n del timeout en reemplazo de lo que debi√≥ ser la respuesta del comercio. Si el comercio no responde con 200 eso no significa que la transaccion haya quedado denegada, siempre deben realizar la consulta para verificar el estado en que quedo la transaccion.

Esta operaci√≥n realiza el vpos para pagos ocasionales y para pagos con token.

![](_page_42_Picture_16.jpeg)

![](_page_43_Picture_0.jpeg)

### **Nota:**

Si el producto Web o Mobile desarrollado por el Comercio inicia la operaci√≥n de compra (single buy) y no recibe la confirmaci√≥n (single buy confirm) por parte del VPOS, puede invocar a la operaci√≥n de consulta (single buy get confirmation) para saber en qu√© estado quedo la transacci√≥n y actualizar en su sistema o tambi√©n puede invocar a la operaci√≥n de reversa (single buy rollback) para evitar inconsistencias en su sistema. El tiempo de espera recomendado es de 10 minutos.

# **Debe completarse con √©xito un Buy Single Confirm para habilitaci√≥n de la correspondiente opci√≥n en la**

# **Lista de test -> Confirmamos correctamente al comercio.**

Obs1: No se marcar√° en la lista de test si es que en el json del pedido env√≠an test\_client.

Obs2: Si el comercio ya cuenta con el vPOS 1.0 ya est√° preparado para recibir la respuesta de los pagos por la url de confirmaci√≥n cargada en el perfil de la aplicaci√≥n del comercio.

### **El pedido estar√° compuesto por un JSON con los siguientes elementos:**

#### Elementos de la petici√≥n

| operation | elemento Operation | Elemento |
|-----------|--------------------|----------|
|-----------|--------------------|----------|

# Elementos Operation

| token            | md5 de la petici√≥n                    | String (32)           |
|------------------|---------------------------------------|-----------------------|
| shop_process_id  | identificador interno del<br>comercio | Entero (15)           |
| response         | Indicador de detalle procesado        | String (1) -<br>S o N |
| response_details | Descripci√≥n del proceso               | String (60)           |

![](_page_43_Picture_12.jpeg)

![](_page_44_Picture_0.jpeg)

| amount                            | Importe en guaran√≠es.                                                                                                                      | Decimal (15,2)<br>-<br>separador decimal '.'                                                                                                                                     |
|-----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| iva_amount                        | Importe en guaran√≠es.<br>Este par√°metro aplica solo<br>para aquellos comercios que<br>deben cumplir con la "Ley de<br>servicios digitales" | Decimal (15,2)<br>-<br>separador decimal '.'                                                                                                                                     |
| currency                          | Tipo de Moneda.                                                                                                                            | String (3) -<br>PYG (Gs)                                                                                                                                                         |
| authorization_number              | C√≥digo de autorizaci√≥n.                                                                                                                    | String (6)<br>-<br>Solo si la transacci√≥n es<br>aprobada.                                                                                                                        |
| ticket_number                     | Identificador de autorizaci√≥n.                                                                                                             | Int (15)                                                                                                                                                                         |
| response_code                     | C√≥digo de respuesta de la<br>transacci√≥n.                                                                                                  | String (2)<br>-<br>00 (transacci√≥n aprobada)<br>-<br>05 (Tarjeta inhabilitada)<br>-<br>12 (Transacci√≥n inv√°lida)<br>-<br>15 (Tarjeta inv√°lida)<br>-<br>51 (Fondos insuficientes) |
| response_description              | Descripci√≥n de la respuesta de<br>transacci√≥n.                                                                                             | String (40)                                                                                                                                                                      |
| extended_response_descriptio<br>n | Descripci√≥n extendida de la<br>respuesta de transacci√≥n.                                                                                   | String (100)                                                                                                                                                                     |
| security_information              | Elemento SecurityInformation                                                                                                               | Elemento                                                                                                                                                                         |
| billing_response                  | Elemento BillingResponse                                                                                                                   | BillingResponse                                                                                                                                                                  |

![](_page_44_Picture_2.jpeg)

![](_page_45_Picture_0.jpeg)

#### Elementos SecurityInformation

| card_source  | Local o Internacional                           | String (1)<br>-<br>L (Local)<br>-<br>I (Internacional) |
|--------------|-------------------------------------------------|--------------------------------------------------------|
| customer_ip  | Ip del cliente que ingresa los<br>datos de pago | String (15)                                            |
| card_country | Pa√≠s de origen de la tarjeta                    | String (30)                                            |
| version      | Version de la API                               | String (5)                                             |
| risk_index   | Indicador de riesgo.                            | Int (1)                                                |

#### Elementos BillingResponse

| status      | Resultado de la operaci√≥n.                              | String (20):<br>. success<br>. error |
|-------------|---------------------------------------------------------|--------------------------------------|
| description | Descripci√≥n del resultado de la<br>operaci√≥n            | String (255)                         |
| data        | Datos adicionales de la factura<br>electr√≥nica generada | DataBilling                          |

# Elementos DataBilling

| invoice_number | Numero de la factura generada | String(32) |
|----------------|-------------------------------|------------|
|                |                               |            |

![](_page_45_Picture_7.jpeg)

![](_page_46_Picture_0.jpeg)

## Ejemplo petici√≥n:

{

 "operation": { "token": "[generated token]", "shop\_process\_id": "12313", "response": "S", "response\_details": "respuesta S", "extended\_response\_description": "respuesta extendida", "currency": "PYG", "amount": "10100.00", "authorization\_number": "123456", "ticket\_number": "123456789123456", "iva\_amount": "1100.0", "iva\_ticket\_number": "2117960079", "response\_code": "00", "response\_description": "Transacci√≥n aprobada.", "security\_information": { "customer\_ip": "123.123.123.123", "card\_source": "I", "card\_country": "Croacia", "version": "0.3", "risk\_index": "0" }, "billing\_response": { "status": "success", "description": "Factura generada correctamente", "data": { "invoice\_number": "001-001-0002563" } } }

### **Notas:**

}

### <span id="page-46-0"></span>**Informaci√≥n √≠ndice de riesgos**

‚óè El atributo de "risk\_index"

![](_page_46_Picture_6.jpeg)

![](_page_47_Picture_0.jpeg)

Consiste en un √≠ndice de riesgo de la transacci√≥n en tiempo real, este campo devolver√° un n√∫mero que indicar√° al comercio el riesgo de la transacci√≥n en tiempo real de acuerdo con la siguiente tabla:

| Escala | Riesgo                                       |
|--------|----------------------------------------------|
| 0      | No se puede generar el riesgo en tiempo real |
| 1      | Bajo                                         |
| 2      | Bajo                                         |
| 3      | Bajo                                         |
| 4      | Medio                                        |
| 5      | Medio                                        |
| 6      | Medio                                        |
| 7      | Alto                                         |
| 8      | Alto                                         |
| 9      | Alto                                         |

El **√≠ndice de riesgo** ser√° generado para las transacciones que se realicen con **tarjeta de cr√©dito local.** 

Para las transacciones con tarjetas internacionales el campo risk\_index mostrar√° 0. Para las transacciones con tarjetas de d√©bito el campo risk\_index mostrar√° 0. Para las transacciones con tarjetas de cr√©dito de otra procesadora (cabal, panal) mostrar√° 0. El campo risk\_index mostrar√° 0 cuando no se puede generar el √≠ndice de riesgo en tiempo real.

![](_page_47_Picture_5.jpeg)

![](_page_48_Picture_0.jpeg)

Acciones del comercio:

- Para una transacci√≥n con Riesgo Bajo, el comercio puede estar tranquilo con la transacci√≥n.
- Para una transacci√≥n con Riesgo Medio, el comercio puede pedir datos de seguridad al cliente para verificar si la transacci√≥n le corresponde.
- Para una transacci√≥n con Riesgo Alto, el comercio debe verificar la transacci√≥n con el cliente y llamar a Bancard en caso de no tener respuesta del cliente, puede escribir un correo a riesgos@bancard.com.py y asegurar la transacci√≥n. En caso de que el comercio tenga que entregar una mercader√≠a, favor primero verificar con Bancard si es una transacci√≥n legitima.

Ejemplo respuesta esperada por el comercio:

"status": "success"

# <span id="page-48-0"></span>**Single Buy Rollback (Operaci√≥n de reversa de transacci√≥n)**

**POST** {environment}/vpos/api/0.3/single\_buy/rollback

Environment

{

}

- **Producci√≥n**  https://vpos.infonet.com.py
- **Staging**  https://vpos.infonet.com.py:8888

Token: md5(private\_key + shop\_process\_id + "rollback" + "0.00")

**Esta operaci√≥n se puede utilizar para pago ocasional, para pagos con token y preautorizaciones confirmadas y tambi√©n para cancelar una preautorizaci√≥n que todav√≠a no se confirm√≥.** 

### **Si una preautorizaci√≥n no se reversa, la misma vence en 30 d√≠as y el monto se le devuelve al usuario.**

La operaci√≥n de Rollback deber√° ser enviada en los siguientes casos:

- Para realizar un reverso de pago.
- Para transacciones canceladas por el usuario en la p√°gina de vPos.
- Para transacciones abandonadas o no culminadas por el usuario.
- Para cancelar una preautorizaci√≥n. Si la preautorizaci√≥n no se cancela la misma expira en 30 d√≠as

![](_page_48_Picture_20.jpeg)

![](_page_49_Picture_0.jpeg)

La operaci√≥n de rollback solo puede enviar en el d√≠a en el que se realiz√≥ la operaci√≥n, a esto lo denominamos reversas autom√°ticas, las que se aplican antes que impacte en el extracto del cliente final.

Si quieren reversar una operaci√≥n que ya impacto en el extracto, deben ingresar su pedido de anulaci√≥n por el canal oficial, portal de comercios/soporte/anulaciones:

| Descarg√° tus<br>$\Box$<br>Facturas<br>Contact√° a Soporte<br>A.<br><b>QUIRLING DUUINGS</b><br>Solicit√° Anulaciones | Reportar nuevo incidente<br>Transacciones $x$<br>$\boldsymbol{\mathsf{3}}$<br>Solicitar ANULACI√ìN | Seleccion√° la categor√≠a correspondiente al incidente (paso 2 de 3) |                      |
|-------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|----------------------|
|                                                                                                                   | B√∫squeda de incidentes<br>Total de incidentes: 0                                                  |                                                                    |                      |
|                                                                                                                   | Identificador                                                                                     | 12 ago. 19 - 11 sep. 19                                            | Seleccione un estado |

La operaci√≥n del Rollback ser√° satisfactoria mientras la transacci√≥n no haya sido CUPONADA (confirmada en el extracto del cliente). Si el JSON devuelve status: error y key:

"TransactionAlreadyConfirmed", el comercio deber√° realizar el proceso manual de pedido de reversi√≥n de una transacci√≥n cuponada a tramitar en el √Årea Comercial de Bancard.

El rollback devolver√° un estado general "status". "success" indica que el pedido ser√° notificado para cancelar. "error" indica que por alguna raz√≥n el pedido no puede continuar. Las posibles causas de error son:

- **InvalidJsonError -** Error en el JSON enviado
- **UnauthorizedOperationError -** Las credenciales enviadas no tienen permiso para la operaci√≥n rollback.
- **ApplicationNotFoundError -** No existen permisos para las credenciales enviadas.
- **InvalidPublicKeyError**  Existe un error sobre la clave p√∫blica enviada.
- **InvalidTokenError**  El token se gener√≥ en forma incorrecta.
- **InvalidOperationError**  El JSON enviado no es v√°lido. No cumple con los tipos o limites definidos.
- **BuyNotFoundError**  No existe el proceso de compra seleccionado
- **PaymentNotFoundError**  No existe un pedido de pago para el proceso seleccionado. Esto quiere decir que el cliente no pag√≥ este pedido y deber√° tomarse como una respuesta correcta para dichas situaciones.
- **AlreadyRollbackedError**  Ya existe un pedido de rollback previo.

![](_page_49_Picture_16.jpeg)

![](_page_50_Picture_0.jpeg)

- **PosCommunicationError**  Existen problemas de comunicaci√≥n con el componente de petici√≥n de rollback. ‚óè
- **TransactionAlreadyConfirmed**  Transacci√≥n Cuponada (Confirmada en el extracto del cliente)

En el caso de que una compra sea iniciada por el producto desarrollado por el comercio, pero no se finalice por el usuario o no se obtenga respuesta de parte de vpos luego de 10 minutos, se deber√≠a invocar un **Get Buy Single Confirmation** para conocer el estado del pedido. Si el pago todav√≠a no ha sido realizado, el comercio puede optar por realizar un rollback del pedido invocando a la operaci√≥n **Single Buy Rollback**.

### **Nota:**

# **Debe completarse con √©xito un Single Buy Rollback manual en un caso de transacci√≥n aprobada para habilitaci√≥n de la correspondiente opci√≥n en la Lista de test ->Recibir rollback**

Obs1: No se marcar√° en la lista de test si es que en el json del pedido env√≠an test\_client.

Obs2: Si el comercio ya cuenta con el vPOS 1.0 esta operaci√≥n ya lo tiene implementada.

### **El pedido estar√° compuesto por un JSON con los siguientes elementos:**

#### Elementos de la petici√≥n

| public_key | Clave p√∫blica      | String   |
|------------|--------------------|----------|
| operation  | Elemento Operation | Elemento |

# Elemento Operation

| token | md5 de la petici√≥n | String |
|-------|--------------------|--------|
|-------|--------------------|--------|

![](_page_50_Picture_13.jpeg)

![](_page_51_Picture_0.jpeg)

| shop_process_id | Identificador interno del<br>comercio | String |
|-----------------|---------------------------------------|--------|
|                 |                                       |        |

Ejemplo petici√≥n:

```
{
  "public_key": "[public key]",
  "elements": {},
  "operation": {
    "token": "[generated token]",
    "shop_process_id": "12313"
  }
}
```

# **La respuesta estar√° compuesta por un JSON con los siguientes elementos:**

Elementos de la respuesta

| status   | Estado de respuesta       | String                     |
|----------|---------------------------|----------------------------|
|          |                           | Valores posibles:          |
|          |                           | -<br>success<br>-<br>error |
| messages | Array de elemento Message | Array                      |

Elemento Message

![](_page_51_Picture_8.jpeg)

![](_page_52_Picture_0.jpeg)

| key   | Clave de respuesta       | String                           |
|-------|--------------------------|----------------------------------|
|       |                          | Valores posibles:                |
|       |                          | -<br>InvalidJsonError            |
|       |                          | -<br>UnauthorizedOperationError  |
|       |                          | -<br>ApplicationNotFoundError    |
|       |                          | -<br>InvalidPublicKeyError       |
|       |                          | -<br>InvalidTokenError           |
|       |                          | -<br>InvalidOperationError       |
|       |                          | -<br>BuyNotFoundError            |
|       |                          | -<br>PaymentNotFoundError        |
|       |                          |                                  |
|       |                          | -<br>AlreadyRollbackedError      |
|       |                          | -<br>PosCommunicationError       |
|       |                          | -<br>RollbackSuccessful          |
|       |                          | -<br>TransactionAlreadyConfirmed |
|       |                          |                                  |
| level | Nivel de despliegue del  | String                           |
|       | mensaje                  | Valores posibles:                |
|       |                          | -<br>info                        |
|       |                          | -<br>error                       |
| dsc   | Descripci√≥n de respuesta | String                           |
|       |                          |                                  |

Ejemplo respuesta:

![](_page_52_Picture_3.jpeg)

![](_page_53_Picture_0.jpeg)

| {<br>"status": "success",         |
|-----------------------------------|
| "messages": [                     |
| {<br>"key": "RollbackSuccessful", |
| "level": "info"                   |
| "dsc": "Rollback correcto.",      |
| }<br>]                            |
| }                                 |

<span id="page-53-0"></span>**Get Buy Single Confirmation(Operaci√≥n de consulta de una transacci√≥n) POST** {environment}/vpos/api/0.3/single\_buy/confirmations

Environment

- **Producci√≥n**  https://vpos.infonet.com.py
- **Staging**  https://vpos.infonet.com.py:8888 Token:

md5(private\_key + shop\_process\_id + "get\_confirmation")

Esta acci√≥n es invocada por el comercio para consultar si existi√≥ o no una confirmaci√≥n.

**Debe completarse con √©xito un Get Buy Single Confirm para habilitaci√≥n de la correspondiente opci√≥n en la Lista de test -> Recibimos pedido de confirmaci√≥n del comercio**

Obs1: No se marcar√° en la lista de test si es que en el json del pedido env√≠an test\_client.

Obs2: Si el comercio ya cuenta con el vPOS 1.0 esta operaci√≥n ya lo tiene implementada.

# **El pedido estar√° compuesto por un JSON con los siguientes elementos:**

Elementos de la petici√≥n

| public_key | Clave p√∫blica. | String (50) |
|------------|----------------|-------------|
|            |                |             |

![](_page_53_Picture_14.jpeg)

![](_page_54_Picture_0.jpeg)

| operation | Elemento Operation | Operation |
|-----------|--------------------|-----------|

Elementos Operation

| token           | md5 de la petici√≥n          | String (32) |
|-----------------|-----------------------------|-------------|
| shop_process_id | identificador de la compra. | Entero (15) |

### **La respuesta estar√° compuesta por un JSON con los siguientes elementos:**

Elementos de la respuesta

| status       | Estado de respuesta         | String                         |
|--------------|-----------------------------|--------------------------------|
|              |                             | Valores posibles:              |
|              |                             | -<br>success<br>-<br>error     |
| confirmation | Informaci√≥n de confirmaci√≥n | Elemento SingleBuyConfirmation |
| messages     | Array de elemento Message   | Array                          |

Elemento Message

![](_page_54_Picture_8.jpeg)

![](_page_55_Picture_0.jpeg)

| key   | Clave de respuesta                 | String                          |
|-------|------------------------------------|---------------------------------|
|       |                                    | Valores posibles:               |
|       |                                    | -<br>InvalidJsonError           |
|       |                                    | -<br>UnauthorizedOperationError |
|       |                                    | -<br>ApplicationNotFoundError   |
|       |                                    | -<br>BuyNotFoundError           |
|       |                                    | -<br>InvalidPublicKeyError      |
|       |                                    | -<br>InvalidTokenError          |
|       |                                    | -<br>InvalidOperationError      |
|       |                                    | -<br>PaymentNotFoundError       |
|       |                                    | -<br>AlreadyRollbackedError     |
| level | Nivel de despliegue del<br>mensaje | String<br>Valores posibles:     |
|       |                                    | -<br>info                       |
|       |                                    | -<br>error                      |
| dsc   | Descripci√≥n de respuesta           | String                          |
|       |                                    |                                 |

# Elemento SingleBuyConfirmation

| token           | MD5 de la petici√≥n                    | String (32) |
|-----------------|---------------------------------------|-------------|
| shop_process_id | Identificador interno del<br>comercio | Entero (15) |

![](_page_55_Picture_4.jpeg)

![](_page_56_Picture_0.jpeg)

| response                          | Indicador de detalle procesado                           | String (1) -<br>S o N                                                                                                                                                            |
|-----------------------------------|----------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| response_details                  | Descripci√≥n del proceso                                  | String (60)                                                                                                                                                                      |
| amount                            | Importe en guaran√≠es.                                    | Decimal (15,2)<br>-<br>separador decimal '.'                                                                                                                                     |
| currency                          | Tipo de Moneda.                                          | String (3) -<br>PYG (Gs)                                                                                                                                                         |
| authorization_number              | C√≥digo de autorizaci√≥n.                                  | String (6)<br>-<br>Solo si la transacci√≥n es<br>aprobada.                                                                                                                        |
| ticket_number                     | Identificador de autorizaci√≥n.                           | Int (15)                                                                                                                                                                         |
| response_code                     | C√≥digo de respuesta de la<br>transacci√≥n.                | String (2)<br>-<br>00 (transacci√≥n aprobada)<br>-<br>05 (Tarjeta inhabilitada)<br>-<br>12 (Transacci√≥n inv√°lida)<br>-<br>15 (Tarjeta inv√°lida)<br>-<br>51 (Fondos insuficientes) |
| response_description              | Descripci√≥n de la respuesta de<br>transacci√≥n.           | String (40)                                                                                                                                                                      |
| extended_response_descriptio<br>n | Descripci√≥n extendida de la<br>respuesta de transacci√≥n. | String (100)                                                                                                                                                                     |
| security_information              | Elemento SecurityInformation                             | Elemento                                                                                                                                                                         |

Elementos SecurityInformation

![](_page_56_Picture_3.jpeg)

![](_page_57_Picture_0.jpeg)

| card_source  | Local o Internacional                           | String (1)<br>-<br>L (Local)<br>-<br>I (Internacional) |
|--------------|-------------------------------------------------|--------------------------------------------------------|
| customer_ip  | Ip del cliente que ingresa los<br>datos de pago | String (15)                                            |
| card_country | Pa√≠s de origen de la tarjeta                    | String (30)                                            |
| version      | Version de la API                               | String (5)                                             |
| risk_index   | Indicador de riesgo.                            | Int (1)                                                |

Ejemplo petici√≥n:

```
{ 
  "public_key": "[public key]", 
  "operation": { 
    "token": "[generated token]", 
    "shop_process_id": "12313" 
  } 
}
```

Ejemplo respuesta:

![](_page_57_Picture_5.jpeg)

![](_page_58_Picture_0.jpeg)

```
{ 
  "status": "success" 
  "confirmation": { 
    "token": "[generated token]", 
    "shop_process_id": "12313", 
    "response": "S", 
    "response_details": "respuesta S", 
    "extended_response_description": "respuesta extendida", 
    "currency": "PYG", 
    "amount": "10100.00", 
    "authorization_number": "123456", 
    "ticket_number": "123456789123456", 
    "response_code": "00", 
    "response_description": "Transacci√≥n aprobada.", 
    "security_information": { 
      "customer_ip": "123.123.123.123", 
      "card_source": "I", 
      "card_country": "Croacia", 
      "version": "0.3", 
      "risk_index": "0" 
    } 
  } 
    }
```

![](_page_58_Picture_2.jpeg)

![](_page_59_Picture_0.jpeg)

<span id="page-59-0"></span>**Preauthorization Confirm(Operaci√≥n de confirmaci√≥n de una preautorizaci√≥n) POST** {environment}/vpos/api/0.3/preauthorizations/confirm

### Environment

- **Producci√≥n**  https://vpos.infonet.com.py
- **Staging**  https://vpos.infonet.com.py:8888 Token:

md5(private\_key + shop\_process\_id + "pre-authorization-confirm")

Operaci√≥n invocada por el comercio para realizar la confirmaci√≥n de una preautorizaci√≥n.

Debe ser invocada cuando el comercio confirme la aprobaci√≥n de una preautorizaci√≥n.

En caso de que ocurra una falla en la comunicaci√≥n, y el portal no est√© seguro de si la confirmaci√≥n se realiz√≥ o no, deber√° reintentar enviando una nueva petici√≥n de confirmaci√≥n.

## **El pedido estar√° compuesto por un JSON con los siguientes elementos:**

# Elementos de la petici√≥n

| public_key | Clave p√∫blica.     | String (50) |
|------------|--------------------|-------------|
| operation  | Elemento Operation | Operation   |

### Elementos Operation

| token           | md5 de la petici√≥n          | String (32) |
|-----------------|-----------------------------|-------------|
| shop_process_id | identificador de la compra. | Entero (15) |

![](_page_59_Picture_14.jpeg)

![](_page_60_Picture_0.jpeg)

| amount  | Importe en guaran√≠es. Dato<br>opcional si es que desea<br>confirmar por otro monto que<br>no sea el preautorizado                                      | Decimal (15,2) -<br>separador<br>decimal '.' |
|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
| billing | Campo reservado para enviar<br>informaci√≥n de facturaci√≥n.<br>Dato opcional si es que desea<br>confirmar por otro monto que<br>no sea el preautorizado | Billing                                      |

#### Elemento Billing

| details | Detalles de √≠tems adquiridos | Array de Details |
|---------|------------------------------|------------------|
|         |                              |                  |

Elemento Details:

| description | Descripci√≥n del articulo<br>adquirido     | String (255)                                 |
|-------------|-------------------------------------------|----------------------------------------------|
| amount      | Precio unitario del articulo<br>adquirido | Decimal (15,2)<br>-<br>separador decimal '.' |
| iva_rate    | Tasa de IVA aplicada al<br>producto.      | Entero (15)                                  |
| total_items | Cantidad del mismo art√≠culo<br>adquirido  | Entero (15)                                  |

**La respuesta estar√° compuesta por un JSON con los siguientes elementos:** 

Elementos de la respuesta

![](_page_60_Picture_8.jpeg)

![](_page_61_Picture_0.jpeg)

| status       | Estado de respuesta         | String                     |
|--------------|-----------------------------|----------------------------|
|              |                             | Valores posibles:          |
|              |                             | -<br>success<br>-<br>error |
| confirmation | Informaci√≥n de confirmaci√≥n |                            |
| messages     | Array de elemento Message   | Array                      |

#### Elemento Message

| key   | Clave de respuesta                 | String                          |
|-------|------------------------------------|---------------------------------|
|       |                                    | Valores posibles:               |
|       |                                    | -<br>InvalidJsonError           |
|       |                                    | -<br>UnauthorizedOperationError |
|       |                                    | -<br>ApplicationNotFoundError   |
|       |                                    | -<br>BuyNotFoundError           |
|       |                                    | -<br>InvalidPublicKeyError      |
|       |                                    | -<br>InvalidTokenError          |
|       |                                    | -<br>InvalidOperationError      |
|       |                                    | -<br>PaymentNotFoundError       |
|       |                                    | -<br>AlreadyRollbackedError     |
| level | Nivel de despliegue del<br>mensaje | String<br>Valores posibles:     |
|       |                                    | -<br>info                       |
|       |                                    | -<br>error                      |

![](_page_61_Picture_4.jpeg)

![](_page_62_Picture_0.jpeg)

### Elemento SingleBuyConfirmation

| token                | MD5 de la petici√≥n                        | String (32)                                                                                                                                                                      |
|----------------------|-------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| shop_process_id      | Identificador interno del<br>comercio     | Entero (15)                                                                                                                                                                      |
| response             | Indicador de detalle procesado            | String (1) -<br>S o N                                                                                                                                                            |
| response_details     | Descripci√≥n del proceso                   | String (60)                                                                                                                                                                      |
| amount               | Importe en guaran√≠es.                     | Decimal (15,2)<br>-<br>separador decimal '.'                                                                                                                                     |
| currency             | Tipo de Moneda.                           | String (3) -<br>PYG (Gs)                                                                                                                                                         |
| authorization_number | C√≥digo de autorizaci√≥n.                   | String (6)<br>-<br>Solo si la transacci√≥n es<br>aprobada.                                                                                                                        |
| ticket_number        | Identificador de autorizaci√≥n.            | Int (15)                                                                                                                                                                         |
| response_code        | C√≥digo de respuesta de la<br>transacci√≥n. | String (2)<br>-<br>00 (transacci√≥n aprobada)<br>-<br>05 (Tarjeta inhabilitada)<br>-<br>12 (Transacci√≥n inv√°lida)<br>-<br>15 (Tarjeta inv√°lida)<br>-<br>51 (Fondos insuficientes) |

![](_page_62_Picture_4.jpeg)

![](_page_63_Picture_0.jpeg)

| response_description              | Descripci√≥n de la respuesta de<br>transacci√≥n.           | String (40)  |
|-----------------------------------|----------------------------------------------------------|--------------|
| extended_response_descriptio<br>n | Descripci√≥n extendida de la<br>respuesta de transacci√≥n. | String (100) |
| security_information              | Elemento SecurityInformation                             | Elemento     |

### Elementos SecurityInformation

| card_source  | Local o Internacional                           | String (1)<br>-<br>L (Local)<br>-<br>I (Internacional) |
|--------------|-------------------------------------------------|--------------------------------------------------------|
| customer_ip  | Ip del cliente que ingresa los<br>datos de pago | String (15)                                            |
| card_country | Pa√≠s de origen de la tarjeta                    | String (30)                                            |
| version      | Version de la API                               | String (5)                                             |
| risk_index   | Indicador de riesgo.                            | Int (1)                                                |

Ejemplo petici√≥n:

![](_page_63_Picture_5.jpeg)

![](_page_64_Picture_0.jpeg)

```
{
 "public_key": "[public key]",
 "operation": {
 "token": "[generated token]",
 "shop_process_id": "12313",
 "amount": 20000,
 "billing": {
 "details": [
 {
 "description": "item 1",
 "amount": "10000.00",
 "iva_rate": 10,
 "total_items": 1
 },
 {
 "description": "item 2",
 "amount": "5000.00",
 "iva_rate": 5,
 "total_items": 2
 }
 ]
 }
 }
}
```

Ejemplo respuesta:

```
{
 "status": "success",
 "confirmation": {
 "token": "[generated token]",
 "shop_process_id": "12313",
 "response": "S",
 "response_details": "respuesta S",
 "extended_response_description": "respuesta extendida",
 "currency": "PYG",
 "amount": "10100.00",
 "authorization_number": "123456",
```

![](_page_64_Picture_4.jpeg)

![](_page_65_Picture_0.jpeg)

```
 "ticket_number": "123456789123456",
 "response_code": "00",
 "response_description": "Transacci√≥n aprobada.",
 "security_information": {
 "customer_ip": "123.123.123.123",
 "card_source": "I",
 "card_country": "Croacia",
 "version": "0.3",
 "risk_index": "0"
 }
 }
```

### <span id="page-65-0"></span>**Operaciones Exclusivas con Facturas Electr√≥nicas**

# <span id="page-65-1"></span>**Get Client Info by RUC (Operaci√≥n para obtener datos de cliente para Factura Electr√≥nica) POST** {environment}/vpos/api/0.3/billing/client\_info

Environment

}

- **Producci√≥n**  https://vpos.infonet.com.py
- **Staging**  https://vpos.infonet.com.py:8888 Token:

md5(private\_key + "billing\_client\_info")

Esta acci√≥n es invocada por el comercio para consultar la informaci√≥n del cliente dado su RUC. Con este servicio el comercio tendr√° la posibilidad de obtener los datos de nombre o raz√≥n social y correo electr√≥nico (campos obligatorios para la generaci√≥n de la factura electr√≥nica) de sus clientes, dado el RUC de los mismos.

Si dado el RUC de un cliente determinado, la consulta al servicio no responde con datos, o dichos datos son incorrectos/desactualizados, los valores del cliente enviados para la emisi√≥n de la factura ser√°n utilizados para actualizar los datos del cliente, de manera que en la pr√≥xima consulta, el servicio responda con los datos actualizados.

La implementaci√≥n de esta operaci√≥n es opcional.

# **El pedido estar√° compuesto por un JSON con los siguientes elementos:**

# Elementos de la petici√≥n

![](_page_65_Picture_13.jpeg)

![](_page_66_Picture_0.jpeg)

| public_key | Clave p√∫blica.     | String (50) |
|------------|--------------------|-------------|
| operation  | Elemento Operation | Operation   |

Elementos Operation

| token      | md5 de la petici√≥n | String (32)    |
|------------|--------------------|----------------|
| client_ruc | RUC del cliente    | String<br>(32) |

# **La respuesta estar√° compuesta por un JSON con los siguientes elementos:**

# Elementos de la respuesta

| status | Estado de respuesta | String                     |
|--------|---------------------|----------------------------|
|        |                     | Valores posibles:          |
|        |                     | -<br>success<br>-<br>error |
| client | Elemento Client     | Client                     |

# Elemento Client

| name  | Nombre o raz√≥n social del<br>cliente | String (100)   |
|-------|--------------------------------------|----------------|
| email | Correo electr√≥nico del cliente       | String<br>(32) |

Ejemplo petici√≥n:

![](_page_66_Picture_10.jpeg)

![](_page_67_Picture_0.jpeg)

```
{
 "public_key": "[public key]",
 "operation": {
 "token": "[generated token]",
 "client_ruc": " 123456-7"
 }
}
```

Ejemplo respuesta:

```
{
 "status": "success",
 "client": {
 "name": "JUAN GONZALEZ",
 "email": "juangonzalez@gmail.com"
 }
```

<span id="page-67-0"></span>**Cancel Generated Invoice (Operaci√≥n para cancelar Factura Electr√≥nica) POST** {environment}/vpos/api/0.3/billing/cancel

Environment

}

- **Producci√≥n**  https://vpos.infonet.com.py
- **Staging**  https://vpos.infonet.com.py:8888 Token:

md5(private\_key + shop\_process\_id + "billing\_cancel")

Esta acci√≥n es invocada por el comercio para cancelar una factura electr√≥nica generada.

La cancelaci√≥n devolver√° un estado general "status". "success" indica que el pedido ser√° notificado para cancelar. "error" indica que por alguna raz√≥n el pedido no puede continuar. Las posibles causas de error son:

‚óè **CancelInvoiceError ‚Äì** Error al procesar la cancelaci√≥n

El detalle del error, si hubiere, estar√° detallado en el campo "dsc".

Consideraciones a tener en cuenta:

- Para la cancelaci√≥n, es necesario que el comprobante haya sido previamente aprobado.
- Las cancelaciones estar√°n permitidas hasta 24 hs despu√©s de haber sido emitidas.

![](_page_67_Picture_16.jpeg)

![](_page_68_Picture_0.jpeg)

La implementaci√≥n de esta operaci√≥n es opcional.

# **El pedido estar√° compuesto por un JSON con los siguientes elementos:**

Elementos de la petici√≥n

| public_key | Clave p√∫blica.     | String (50) |
|------------|--------------------|-------------|
| operation  | Elemento Operation | Operation   |

Elemento Operation

| token           | md5 de la petici√≥n                    | String |
|-----------------|---------------------------------------|--------|
| shop_process_id | Identificador interno del<br>comercio | String |

Ejemplo petici√≥n:

```
{
 "public_key": "[public key]",
 "operation": {
 "token": "[generated token]",
 "shop_process_id": "12313"
 }
}
```

**La respuesta estar√° compuesta por un JSON con los siguientes elementos:** 

Elementos de la respuesta

![](_page_68_Picture_11.jpeg)

![](_page_69_Picture_0.jpeg)

| status   | Estado de respuesta       | String                     |  |  |
|----------|---------------------------|----------------------------|--|--|
|          |                           | Valores posibles:          |  |  |
|          |                           | -<br>success<br>-<br>error |  |  |
| messages | Array de elemento Message | Array                      |  |  |
|          |                           |                            |  |  |

### Elemento Message

| key   | Clave de respuesta                 | String<br>-<br>CancelInvoiceError<br>-<br>CancelInvoiceSuccessful |
|-------|------------------------------------|-------------------------------------------------------------------|
| level | Nivel de despliegue del<br>mensaje | String<br>Valores posibles:<br>-<br>info<br>-<br>error            |
| dsc   | Descripci√≥n de respuesta           | String                                                            |

Ejemplo respuesta:

![](_page_69_Picture_5.jpeg)

![](_page_70_Picture_0.jpeg)

```
{
 "status": "success",
 "elements": {},
 "messages": [
 {
 "key": " CancelInvoiceSuccessful ",
 "level": "info",
 "dsc": "Cancelaci√≥n correcta de factura electr√≥nica."
 }
 ]
}
```

### <span id="page-70-0"></span>**Flujo de una Preautorizacion:**

Preautorizacion cuenta con dos flujos distintos, uno para Tarjeta de Cr√©dito (TC) y otro para tarjeta de D√©bito (TD)

### **Flujo con Tarjeta de cr√©dito:**

- <span id="page-70-1"></span>1. El comercio env√≠a la Preautorizacion por un monto X (ejemplo: 100.000 Gs).
- 2. Dicho Monto se congela en la cuenta del cliente, es decir, el comercio aun no recibe el dinero, el usuario ve el d√©bito, pero este no impacta aun en la cuenta del comercio.
- <span id="page-70-2"></span>3. El comercio env√≠a la confirmaci√≥n de la Preautorizacion.

**Observaci√≥n:** 

- Si el monto es menor al Preautorizado (ejemplo: se confirma por 90.000 Gs), se realiza un c√°lculo de la diferencia (100.000 Gs ‚Äì 90.000 Gs = 10.000 Gs), el resultado de dicha diferencia se acredita nuevamente al usuario y el monto confirmado es el que pasa a la cuenta del comercio.
- Si el monto es mayor al Preautorizado, solo se acepta hasta un 20% mayor (ejemplo: se confirma por 110.00 Gs), en estos casos se realiza un debito adicional al usuario por la diferencia entre el monto confirmado y el monto preautorizado (110.000 Gs ‚Äì 100.000 Gs = 10.000 Gs).
- En el caso de que el comercio env√≠e la cancelaci√≥n en vez de la confirmaci√≥n, el monto inicial se descongela de la cuenta del usuario, es decir, el monto que inicialmente se preautorizo se le vuelve a habilitar al usuario para su uso normal.
- Si no se realiza la confirmaci√≥n a los 30 d√≠as de la preautorizacion, la misma se cancela de manera autom√°tica y se devuelve la plata al usuario.
- El comercio puede cancelar la Preautoriacion invocando la Api mencionada m√°s arriba
- En caso de que falle la confirmaci√≥n, el comercio puede cancelar la preautorizacion sin la necesidad de esperar a que esta se cancele a los 30 d√≠as.
- Todo el Flujo de la Preautorizacion con TC se hace bajo la misma boleta Bancard.

![](_page_70_Picture_16.jpeg)

![](_page_71_Picture_0.jpeg)

- Una preautorizaci√≥n solo puede ser confirmada una vez y no es posible hacer el reintento de la confirmaci√≥n. Es decir, si una confirmaci√≥n queda rechazada entonces no puede volver a ser reintentada.
- La confirmaci√≥n es una operaci√≥n fundamental para la preautorizaci√≥n y solo al obtener la confirmaci√≥n aprobada se considera la transacci√≥n como finalizada correctamente. Entonces el comercio debe de esperar a tener la confirmaci√≥n aprobada para la entrega de cualquier mercader√≠a o servicio.
- 4. Se realiza el flujo transaccional y se acredita en la cuenta del comercio, esto no es en l√≠nea debido a que sigue el flujo de una transacci√≥n con Tarjeta de cr√©dito.

# **Flujo con Tarjeta de d√©bito:**

- <span id="page-71-0"></span>1. El comercio env√≠a la Preautorizacion por un monto X (ejemplo: 100.000 Gs).
- 2. A diferencia de la preautorizacion con TC, en este caso al enviar la misma ya se realiza el movimiento de dinero, es decir, se acredita el monto preautorizado en la cuenta del comercio.
- 3. El comercio env√≠a la confirmaci√≥n de la Preautorizacion.

### <span id="page-71-1"></span>**Observaci√≥n:**

- Si el monto es menor al Preautorizado (ejemplo: se confirma por 90.000 Gs), se realiza un c√°lculo de la diferencia (100.000 Gs ‚Äì 90.000 Gs = 10.000 Gs), el resultado de dicha diferencia se acredita nuevamente al usuario y el monto confirmado es el que queda en la cuenta del comercio.
- En preautorizacion con TD no es posible enviar montos mayores.
- En el caso de que el comercio env√≠e la cancelaci√≥n en vez de la confirmaci√≥n, se realiza una transacci√≥n a la inversa para devolver la plata al usuario, es decir, se hace una transferencia de la cuenta del comercio a la cuenta del usuario.
- Si no se realiza la confirmaci√≥n a los 30 d√≠as de la preautorizacion, la misma se cancela de manera autom√°tica y se devuelve la plata al usuario.
- El comercio puede cancelar la Preautoriacion invocando la Api mencionada m√°s arriba.
- En caso de que falle la confirmaci√≥n, el comercio puede cancelar la preautorizacion sin la necesidad de esperar a que esta se cancele a los 30 d√≠as.
- El flujo de la preautorizacion con TD se realizan en boletas bancard distintas, es decir, se genera una boleta para la preautorizacion y confirmaci√≥n.
- Una preautorizaci√≥n solo puede ser confirmada una vez y no es posible hacer el reintento de la confirmaci√≥n. Es decir, si una confirmaci√≥n queda rechazada entonces no puede volver a ser reintentada.
- La confirmaci√≥n es una operaci√≥n fundamental para la preautorizaci√≥n y solo al obtener la confirmaci√≥n aprobada se considera la transacci√≥n como finalizada correctamente. Entonces el comercio debe de esperar a tener la confirmaci√≥n aprobada para la entrega de cualquier mercader√≠a o servicio.

![](_page_71_Picture_18.jpeg)

![](_page_72_Picture_0.jpeg)

4. Luego de enviar la confirmaci√≥n y que la misma quede aprobada, finaliza el flujo, la acreditaci√≥n es en l√≠nea, debido a que se trata de una transacci√≥n con TD.

#### <span id="page-72-0"></span>**Restricciones del comercio**

A continuaci√≥n, se presentan restricciones que debe contemplar el comercio que desarrolle la integraci√≥n con el eCommerce de Bancard.

#### Interfaz de respuesta

Luego de que el usuario ingresa sus datos de tarjeta y se confirma al comercio por medio de la operaci√≥n "Buy Single Confirm" el comercio debe desplegar una interfaz de respuesta con la aprobaci√≥n de la transacci√≥n.

En esta interfaz se deben respetar las siguientes restricciones:

‚óè Se deben indicar los datos de la transacci√≥n:

Fecha y Hora

N√∫mero de pedido (shop\_process\_id)

Importe (amount)

Descripci√≥n de la Respuesta (response\_description)

‚óè **No** debe mostrarse al usuario:

C√≥digo de autorizaci√≥n (authorization\_number)

C√≥digo de respuesta (response\_code)

Respuesta extendida (extended\_response\_description)

Informaci√≥n de seguridad (security\_information)

# Notas generales

- El Comercio debe incluir en su aplicaci√≥n la secci√≥n de **Contacto**, de manera que el cliente pueda evacuar consultas referentes a las compras del ecommerce.
- La aplicaci√≥n podr√° registrar todos datos del cliente que requiera el comercio, salvo todos aquellos que se relacionen a sus tarjetas de cr√©dito (N√∫mero de tarjeta, c√≥digo de seguridad, vencimiento, etc.)

![](_page_72_Picture_20.jpeg)

![](_page_73_Picture_0.jpeg)

- El logo para utilizar por el comercio debe idealmente tener un ancho de 173 p√≠xeles y un alto 55 p√≠xeles. El ancho m√≠nimo es de 85 p√≠xeles.
- Para la comunicaci√≥n con nuestro web en ambiente de desarrollo deben tener habilitado el puerto 8888.

#### Formato de mensajer√≠a ‚Äì JSON

Para enviar y recibir informaci√≥n se emplear√° el formato JSON (JavaScript Object Notation).

Informaci√≥n sobre JSON [-](http://json.org/) <http://json.org/>

Validaci√≥n de JSON [-](http://jsonlint.com/) <http://jsonlint.com/>

Al consumir un JSON enviado por el VPOS debe prestarse especial atenci√≥n a los caracteres especiales (ej. tildes). El mismo ser√° enviado utilizando el standard "\uXXXX" (Donde X es un digito hexadecimales)

Los JSON enviados y recibidos por Bancard y el comercio deber√°n realizarse mediante una petici√≥n POST enviando el JSON en el cuerpo del pedido o body.

### <span id="page-73-0"></span>**Solicitud de pase a producci√≥n**

El comercio deber√° completar la lista de test para solicitar la certificaci√≥n y pr√≥ximo paso a producci√≥n, los pasos a producci√≥n son los siguientes:

- El comercio debe completar su lista de test, todos los campos deben tener chequeado, mientras hacen sus pruebas cada √≠tem de la lista de test se marca en verde.
- Al tener la lista de test completamente chequeado, se habilita el boton de **"Solicitar certificaci√≥n"**
- En el bot√≥n el comercio carga la url a certificar y un usuario/contrase√±a si se necesita para realizar las pruebas en su sitio
- El pedido de certificaci√≥n llega al equipo de soporte, donde hacen compras de prueba en la url dada, si vemos que la integraci√≥n se encuentra ok entonces se les da el acceso a producci√≥n.
- Se habilita una pesta√±a de producci√≥n donde el comercio tiene las claves de producci√≥n y puede configurar su perfil de aplicaci√≥n en producci√≥n
- Tambi√©n el comercio debe cambiar las urls de las apis por las de producci√≥n.

![](_page_73_Picture_17.jpeg)

![](_page_74_Picture_0.jpeg)

| vPOS - PRUEBA-E COMMERCE VP (77)                                                                                                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Documentaci√≥n                                                                         | Staging | Producci√≥n                 |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|---------|----------------------------|
| Lista de tests<br>vP09:2:0<br>VROS10<br>Traza de actividad<br>Claves:<br>Perfii de aplicaci√≥n<br>Comercias habilitados<br>Cliente de phieba<br>WRDS 2:0<br>$\text{PDS10}$ | Permisos de staging<br>Habilitar permission be access a stugging 30/W2915-38.9F<br>Ingreso de configuraci√≥n del cliente<br>Core publicary provide 12:01:2016-1521.<br>Uni de conformaci√≥n 2001/2016-10:30.<br>Logo (3/19/2019-1725)<br>implementaci√≥n de gestion de tarjetas<br><b>Holighat de catastur: \$789206-1488</b><br>Catarino de tanjeto - 04/05/2018 - 12:11<br>Racibe tarpetas del usuamo - 10 80 2015 - 96 27<br>Eliminar tatjeta del umario 13/00/2016-26:50<br>implementaci√≥n del pago con alias token<br>Page con alian islam 1000/2016 10:38<br>Compra militiple con alias folium 48:44201-1243 | 39/04/2010 18:30<br><b>HOMOMA MAS</b><br>TAXABILITY OF ST<br><b>36/04/2010 -12:43</b> |         |                            |
|                                                                                                                                                                           | Deber√°s impresar informaci√≥n de contacto par√° collicitar el pase a producci√≥n. El Oltimo pase a producci√≥n fue opticitado<br>ert la Secha: 12/10/2018 - 11:41                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                       |         | Solicitar<br>certificaci√≥n |

# <span id="page-74-0"></span>**Mejoras visuales sobre los formularios de catastros y pagos ocasionales**

Como parte del objetivo de Bancard de ofrecer soluciones modernas, se han redise√±ado los formularios de catastros y pagos ocasionales.

Estos nuevos formularios mantienen la capacidad de ser responsive y tambi√©n recibieron nuevas opciones de personalizaci√≥n en el portal de comercios. Estas opciones se detallar√°n m√°s adelante.

Tambi√©n es posible utilizar los nuevos temas prove√≠dos por el portal de comercios, siendo todos ellos tambi√©n personalizables por el comercio.

El requisito para poder implementar estos formularios es que se les d√© un ancho **m√≠nimo de 320px**. Se ha decido por este tama√±o m√≠nimo por ser un est√°ndar de la industria.

# <span id="page-74-1"></span>**Transici√≥n de los formularios a los nuevos estilos**

Si el comercio ya cuenta con los formularios de pagos ocasionales o de catastros y los han personalizados, estas personalizaciones se mantendr√°n al lanzarse las mejoras visuales

El comercio podr√° seguir operando de manera corriente y no es necesario realizar ajustes sobre la personalizaci√≥n o implementaci√≥n de los formularios para poder seguir utiliz√°ndolos.

![](_page_74_Picture_10.jpeg)

![](_page_75_Picture_0.jpeg)

### <span id="page-75-0"></span>**Formulario de catastro**

El nuevo formulario de catastro se ha ajustado para poder incluir todos los datos necesarios del usuario en una sola vista. Esto es, el n√∫mero de c√©dula se pedir√° junto a los datos de la tarjeta y al hacer click sobre el bot√≥n de acci√≥n entonces ya se finalizar√° el proceso de catastro.

| Vista previa del formulario de catastros ‚Äì | Tema por defecto |  |
|--------------------------------------------|------------------|--|
|                                            |                  |  |
|                                            |                  |  |
|                                            |                  |  |
|                                            |                  |  |
|                                            |                  |  |
|                                            |                  |  |
|                                            |                  |  |
|                                            |                  |  |
|                                            |                  |  |
|                                            |                  |  |

#### <span id="page-75-1"></span>**Formulario de pagos ocasionales**

Si bien se ha modernizado la interfaz del formulario de pagos ocasionales, a nivel de flujos el formulario b√°sicamente sigue siendo lo mismo. Es decir, se mejorado la legibilidad y usabilidad sin que esto pueda afectar a la funcionalidad del mismo.

La opci√≥n de pago con tarjetas se ha a√±adido, esto con miras a implementar otros m√©todos de pagos en el futuro.

![](_page_75_Picture_7.jpeg)

![](_page_76_Picture_0.jpeg)

| $\mathcal{L} \mathcal{L}$<br><b>Tarjeta</b> |            |  |  |  |
|---------------------------------------------|------------|--|--|--|
| N√∫mero de tarjeta                           |            |  |  |  |
| 1234 1234 1234 1234                         |            |  |  |  |
| Fecha de Expiraci√≥n                         | C√≥digo CVC |  |  |  |
| MM / AA                                     | CVC        |  |  |  |
| Cuotas (s√≥lo Paraguay)                      |            |  |  |  |
| 1                                           |            |  |  |  |
| Pagar (Gs. 946.631)                         |            |  |  |  |
| Pago seguro<br>tandards Council<br>ancard   |            |  |  |  |

# <span id="page-76-0"></span>**Nuevas opciones de personalizaci√≥n**

Se han agregado varias nuevas opciones y herramientas con el fin de ayudar a la personalizaci√≥n de los formularios.

La cantidad de opciones a personalizar sobre los formularios ha aumentado y se agregaron las herramientas de **temas por defecto** y **una vista previa.**

Nueva vista de personalizaci√≥n

![](_page_76_Picture_6.jpeg)

![](_page_77_Picture_0.jpeg)

| Personalizaci√≥n del formulario<br>Temas <b>T</b> |                              |          | Pago Simple                             |                                         | Registro de Tarjeta                                              |                |  |
|--------------------------------------------------|------------------------------|----------|-----------------------------------------|-----------------------------------------|------------------------------------------------------------------|----------------|--|
| Color fondo de campos                            |                              |          | $\equiv$                                |                                         |                                                                  |                |  |
| Color texto de campos                            |                              |          | Card                                    |                                         |                                                                  |                |  |
| Color borde de campos                            |                              |          |                                         |                                         |                                                                  |                |  |
| Color fondo del bot√≥n                            |                              |          | Card number<br>1234 1234 1234 1234      |                                         | $\mathbf{p}_{\mathbf{c}_{\mathbf{B}}}^{\mathbf{c}_{\mathbf{B}}}$ |                |  |
| Color texto del bot√≥n                            |                              |          |                                         |                                         |                                                                  |                |  |
| Color borde del bot√≥n                            |                              |          | Expiration                              | CVC                                     |                                                                  |                |  |
| Color fondo de formulario                        |                              |          | MM/YY                                   | CVC                                     | $\overline{\mathbb{Q}_{\infty}}$                                 | $\overline{2}$ |  |
| Color del borde del formulario                   |                              |          |                                         | <b>Click</b>                            |                                                                  |                |  |
| Color fondo de encabezado                        |                              |          |                                         |                                         |                                                                  |                |  |
| Color texto de encabezado                        | $\qquad \qquad \blacksquare$ |          | $\big)^{\mathsf{Page\,seguro}}$ Bancard | <b>PC</b> Security<br>Standards Council |                                                                  |                |  |
| Color de linea separadora                        |                              |          |                                         |                                         |                                                                  |                |  |
| Color texto de tu-eres-tu                        |                              |          |                                         |                                         |                                                                  |                |  |
| Color texto de etiquetas                         |                              | Deshacer |                                         |                                         |                                                                  | Copiar JSON    |  |

# Adem√°s de las personalizaciones existentes se han agregado las siguientes opciones:

| Opci√≥n                   | Descripci√≥n                                 | Valor por defecto |
|--------------------------|---------------------------------------------|-------------------|
| Color texto de tu-eres   | Opci√≥n que afecta a los colores del texto   | #555555           |
| tu                       | del enlace de T√©rminos y condiciones        |                   |
| Color texto de etiquetas | Esto afecta a las etiquetas de los campos,  | #555555           |
|                          | tales como n√∫mero de tarjeta, fecha de      |                   |
|                          | vencimiento o CVC.                          |                   |
| Color del placeholder    | Afecta a los textos de ejemplo que se       | #999999           |
|                          | encuentran en los campos. Por ejemplo, el   |                   |
|                          | del n√∫mero de tarjeta es el texto 1234      |                   |
|                          | 1234 1234 1234.                             |                   |
| Color mensajes de error  | Este color ser√° tomado por los mensajes     | #b50b0b           |
|                          | de error en las validaciones de los campos. |                   |
|                          | Est√°n ocultos por defecto, por lo que para  |                   |
|                          | verificarlos es necesario enviar el         |                   |
|                          | formulario con datos incorrectos.           |                   |

![](_page_77_Picture_4.jpeg)

![](_page_78_Picture_0.jpeg)

| Color icono CVV         | Esto es para el color que tomar√° el icono<br>#0a0a0a |            |
|-------------------------|------------------------------------------------------|------------|
|                         | que se encuentra del campo CVV.                      |            |
| Color principal de la   | Aplica para el borde y texto de la pesta√±a           | #5CB85C    |
| pesta√±a                 | de m√©todo de pago.                                   |            |
| Color de fondo de la    | Aplica para el color de fondo de la pesta√±a          | #999999    |
| Pesta√±a                 | de m√©todo de pago.                                   |            |
| Radio del borde de los  | Estilo del borde de los campos. Pueden               | Redondeado |
| inputs                  | tener los siguientes valores:                        |            |
|                         | -<br>Redondeado                                      |            |
|                         | -<br>P√≠ldora                                         |            |
|                         | -<br>Recto                                           |            |
| Tama√±o del texto del    | Ajuste el tama√±o de todas las fuentes del            | Normal     |
| formulario              | formulario.                                          |            |
|                         | Se debe de tener en cuenta de que colocar            |            |
|                         | un tama√±o de fuente grande puede                     |            |
|                         | ocasionar problemas al mostrar el                    |            |
|                         | formulario.                                          |            |
| Fuente del texto del    | Ofrece un listado de fuentes posibles a ser          |            |
| formulario              | utilizados para todos los textos del                 |            |
|                         | formulario.                                          |            |
| Posici√≥n de la etiqueta | La ubicaci√≥n de las etiquetas puede variar           | Flotante   |
|                         | entre dos posibles valores:                          |            |
|                         | -Flotante                                            |            |
|                         | -Encima                                              |            |
|                         |                                                      |            |

### <span id="page-78-0"></span>**Vista previa**

De manera a facilitar la edici√≥n de los formularios, se ha colocado la nueva herramienta de la vista previa en el perfil de aplicaciones del portal de comercio. La vista previa esta preparada para tomar de manera autom√°tica cada cambio de valor en las opciones del formulario y mostrar el ajuste sin que esto afecte a los formularios utilizados por los usuarios.

Los ajustes en la configuraci√≥n, como siempre, aplicar√°n para los formularios de catastros y pagos ocasionales. Por lo tanto, se ofrece una vista previa de ambas formulario.

Los cambios se aplicar√°n autom√°ticament4e solo a la vista previa. Para trasladar los ajuste a los formularios, se deben de **confirmarlos** utilizando el bot√≥n **guardar**.

En caso de que se quieran volver atr√°s los ajustes no confirmados, se puede utilizar el bot√≥n **deshacer**.

Tambi√©n se tiene la opci√≥n de poder copiar un JSON con los estilos cargados en la vista previa.

![](_page_78_Picture_8.jpeg)

![](_page_79_Picture_0.jpeg)

| Temas                          |          |                                                               |                                         |                     |
|--------------------------------|----------|---------------------------------------------------------------|-----------------------------------------|---------------------|
| Color texto del bot√≥n          |          | Pago Simple                                                   |                                         | Registro de Tarjeta |
| Color borde del bot√≥n          |          |                                                               |                                         |                     |
| Color fondo de formulario      |          | <b>Tarjeta</b>                                                |                                         |                     |
| Color del borde del formulario |          |                                                               |                                         |                     |
| Color fondo de encabezado      |          | N√∫mero de tarjet                                              |                                         |                     |
| Color texto de encabezado      |          |                                                               |                                         |                     |
| Color de linea separadora      |          | Expiraci√≥n                                                    | CVC<br>$\overline{\mathbb{Q}}$          | $\odot$             |
| Color texto de tu-eres-tu      |          |                                                               |                                         |                     |
| Color texto de etiquetas       |          | Presionar                                                     |                                         |                     |
| Color del placeholder          |          | $\overline{\mathbf{B}}^{\text{Page seguro}}_{\text{Bancard}}$ | <b>PC</b> Security<br>Standards Council |                     |
| Color mensajes de error        |          |                                                               |                                         |                     |
| Color icono CVV                | Deshacer |                                                               |                                         | Copiar JSON         |

# Opciones para la vista previa

Recordar que los entornos de Sandbox y Producci√≥n cuentan con sus propios estilos y es importante **realizar los cambios dentro de la pesta√±a correspondiente**.

# <span id="page-79-0"></span>**Temas predefinidos**

Junto con la herramienta de vista previa, se tiene la opci√≥n de utilizar temas predefinidos como base. Al seleccionar uno de los temas, la vista previa tomar√° de manera autom√°tica los estilos asociados al tema.

![](_page_79_Picture_7.jpeg)

![](_page_80_Picture_0.jpeg)

### Temas predefinidos disponibles

![](_page_80_Figure_2.jpeg)

Es posible tambi√©n utilizar estos tema predefinidos como base y sobre ellos realizar ajustes a los Lariosarios.

#### <span id="page-80-0"></span>**C√≥digo de errores ‚Äì Vpos 2.0**

| C√≥digo de errores Vpos 2.0                    |                                                                                  |  |
|-----------------------------------------------|----------------------------------------------------------------------------------|--|
| Card errors (C√≥digo Errores para el catastro) |                                                                                  |  |
| CardAlreadyRegisteredByUserError              | 'The user has already registered the card.'                                      |  |
| InvalidCiError                                | "The user's ci does not match with card's ci"                                    |  |
| CardRequestAlreadyProcessedError              | "The card request with process id #{@process_id} has already been<br>processed." |  |
| CardInvalidDataError                          | 'The data for the card is not correct.'                                          |  |
| NewCardRequestNotFoundError                   | "New card<br>request not found for process id: #{@process_id}"                   |  |
| CardNotFoundError                             | 'The card does not exist'                                                        |  |
| CardAliasTokenExpiredError                    | 'The card alias token has expired.'                                              |  |
| CardBlockedError                              | 'The card for the user is blocked.'                                              |  |
| InvalidCardStatus                             | 'The given status is incorrect                                                   |  |

| Buy errors (C√≥digo de errores para pedido de pago) |                                               |  |
|----------------------------------------------------|-----------------------------------------------|--|
| BuyNotFoundError                                   | 'Buy Not Found'                               |  |
| InvalidAmountError                                 | "Amount attribute must be greater than zero." |  |

![](_page_80_Picture_7.jpeg)

![](_page_81_Picture_0.jpeg)

| Application errors (C√≥digo de errores para APIS vpos) |                                                            |  |
|-------------------------------------------------------|------------------------------------------------------------|--|
| ApplicationNotFoundError                              | 'Application not found'                                    |  |
| InvalidTokenError                                     | 'Invalid token'                                            |  |
| InvalidPublicKeyError                                 | 'Invalid Public key'                                       |  |
| PublicKeyNotFoundError                                | 'Public key not found'                                     |  |
| ApplicationCommunicationError                         |                                                            |  |
| ApplicationCredentialNotFoundError                    | "The credential for the application was not found."        |  |
| CantCreateApplicationCredentialError                  | "The credential for the application could not be created." |  |

| C√≥digo de errores en los pagos |                                                |  |
|--------------------------------|------------------------------------------------|--|
|                                | 0 APROBADA                                     |  |
|                                | 2 CONSULTE SU EMISOR -<br>CONDICION ESPECIAL   |  |
|                                | 3 NEGOCIO INVALIDO                             |  |
|                                | 4 RETENGA TARJETA                              |  |
|                                | 5 NO APROBADO                                  |  |
|                                | 6 ERROR DE SISTEMA                             |  |
|                                | 7 RECHAZO POR CONTROL DE SEGURIDAD             |  |
|                                | 8 TRANSACCION FALLBACK RECHAZADA               |  |
|                                | 12 TRANSACCION INVALIDA                        |  |
|                                | 13 MONTO INVALIDO                              |  |
|                                | 14 TARJETA INEXISTENTE                         |  |
|                                | 15 EMISOR INEXISTENTE, NO HABILITADO P/NEGOC   |  |
|                                | 17 CANCELADO POR EL CLIENTE                    |  |
|                                | 19 INTENTE OTRA VEZ                            |  |
|                                | 22 SOSPECHA DE MAL FUNCIONAMIENTO              |  |
|                                | 33 TARJETA VENCIDA                             |  |
|                                | 34 POSIBLE FRAUDE -<br>RETENGA TARJETA         |  |
|                                | 35 LLAME PROCESADOR/ADQUIRENTE                 |  |
|                                | 36 TARJETA/CUENTA BLOQUEADA POR LA ENTIDAD     |  |
|                                | 37 MES NACIMIENTO INCORRECTO-TARJ.BLOQUEADA    |  |
|                                | 38 3 CLAVES EQUIVOCADAS -<br>TARJETA BLOQUEADA |  |
|                                | 39 NO EXISTE CUENTA DE TARJETA DE CREDITO      |  |
|                                | 40 TIPO DE TRANSACCION NO SOPORTADA            |  |

![](_page_82_Picture_0.jpeg)

| 41 TARJETA PERDIDA -<br>RETENGA TARJETA        |
|------------------------------------------------|
| 42 NO APROBADO -<br>NO EXISTE CUENTA UNIVERSAL |
| 43 TARJETA ROBADA -<br>RETENGA TARJETA         |
| 45 NO EXISTE LA CUENTA                         |
| 46 EMISOR/BANCO NO RESPONDIO EN 49 SEGUNDOS    |
| 49 OPERACION NO ACEPTADA EN CUOTAS             |
| 51 NO APROBADA-INSUF.DE FONDOS                 |
| 54 TARJETA VENCIDA                             |
| 55 CLAVE INVALIDA                              |
| 57 NO APROBADA -<br>TARJETA INADECUADA         |
| 58 NO HABILITADA PARA ESTA TERMINAL            |
| 59 NO APROBADO -<br>POSIBLE FRAUDE             |
| 60 NO APROBADO -<br>CONSULTE PROCESADOR ADQUIR |
| 61 EXCEDE MONTO LIMITE                         |
| 62 NO APROBADA -<br>TARJETA RESTRINGIDA        |
| 63 VIOLACION DE SEGURIDAD                      |
| 65 EXCEDE CANTIDAD DE OPERACIONES              |
| 66 LLAMAR SEGURIDAD DEL PROCESADOR ADQUIR.     |
| 70 NEGOCIO INHABILITADO POR FALTA DE PAGO      |
| 71 OPERACI√ìN YA EXTORNADA                      |
| 72 FECHA INVALIDA                              |
| 73 CODIGO DE SEGURIDAD INVALIDO                |
| 92 EMISOR DESCONECTADO -<br>PROBLEMAS EN LINEA |
| 94 TRANSACCION DUPLICADA -<br>NO APROBADO      |

![](_page_82_Picture_2.jpeg)

![](_page_83_Picture_0.jpeg)

### **Soporte para la integraci√≥n**

**Ingrese al sitio: https://comercios.bancard.com.py, utilice la opci√≥n de men√∫ Soporte, y el servicio vPOS.** 

**Si se trata de una consulta de integraci√≥n utilice la opci√≥n Pruebas de integraci√≥n (desarrollo), estas consultas ser√°n atendidas de lunes a viernes en horario de oficina** 

![](_page_83_Picture_4.jpeg)